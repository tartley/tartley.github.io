<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A website devoted to oneself has been described, by my Father, no less, as the greatest act of hubris. Welcome aboard!">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Made out of meat</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://www.tartley.com/">
<link rel="icon" href="welcome.gif" sizes="16x16">
<link rel="next" href="index-27.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/illustrating-uses-of-ibm-cloud-security-groups/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://www.tartley.com/">

                <span id="blog-title">Made out of meat</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Posts</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="galleries/Drawings">Gallery</a>
                </li>
<li>
<a href="rss.xml">RSS</a>
                </li>
<li>
<a href="pages/about/">About</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://www.tartley.com/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    <a rel="me" href="https://mastodon.social/@tartley"></a>
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/illustrating-uses-of-ibm-cloud-security-groups/" class="u-url">Illustrating Uses of IBM Cloud Security Groups</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/illustrating-uses-of-ibm-cloud-security-groups/" rel="bookmark">
            <time class="published dt-published" datetime="2023-08-22T21:33:47-05:00" itemprop="datePublished" title="2023-08-22 21:33">2023-08-22 21:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <blockquote>
<p>I wrote this high-level public-facing guide while employed by IBM, creating
the security groups feature for IBM Cloud. It
<a href="https://web.archive.org/web/20210418195246/https://www.ibm.com/cloud/blog/illustrating-uses-ibm-cloud-security-groups">used to reside</a>
on the IBM blog, but has recently been replaced by newer content, so I've
preserved it here for posterity.</p>
</blockquote>
<p>This article illustrates a few possible uses of IBM Cloud Security Groups, a
per-instance firewall for IBM Cloud virtual instances.</p>
<h3>Why Use Security Groups?</h3>
<p>Security groups firewall your IBM Cloud applications from nefarious network
traffic, protecting you and your company from the efforts of “industrious
users” trying to bring down your application, or make off with your customer's
credit card details. If those sound like sub-optimal outcomes for your
situation, read on…</p>
<h3>Allow Incoming SSH Connections</h3>
<p>The simplest use of security groups is to allow a single type of network
connection to your instances, blocking all other traffic. For example, to allow
only incoming SSH connections, which are TCP connections on port 22. All other
types of traffic, such as ICMP ‘ping' connections, or TCP connections on other
ports, are blocked. Fig 1. A security group configured to allow incoming SSH</p>
<p><img alt="A diagram representing SSH connections being allowed from support engineer to instances within security group 1, while ping connections are denied" src="files/2023/ibm-cloud/1_allow-ssh-1.webp"></p>
<p><em>Fig 1. A security group configured to allow incoming SSH.</em></p>
<p>When instances 1 &amp; 2 are added to your security group, firewalls are created
directly on those instances,configured to allow or deny the corresponding
traffic. Hence, your support engineer can create SSH connections, but cannot
send arbitrary network traffic.</p>
<h3>Allow SSH from a Specified IP Address</h3>
<p>The above scenario allows SSH connection attempts from any IP address. To
increase security, you might only allow connections from a particular instance.
Fig 2. A security group configured to allow incoming SSH connections (TCP port
22) from a particular IP address.</p>
<p><img alt="A diagram representing SSH conections being allowed from a known IP address to instances within security group 1, while connections from a disgruntled employee at a different IP address are denied" src="files/2023/ibm-cloud/2_allow-ssh-one-ip.webp"></p>
<p><em>Fig 2. A security group configured to allow incoming SSH connections (TCP port
22) from a particular IP address.</em></p>
<p>The security group has been configured with the IP address used by a support
engineer – the single instance that is authorized to make a connection.
Connections from other instances are blocked.</p>
<p>As well as allowing traffic from a single IP address, security groups can be
configured with a CIDR block, to allow traffic from all instances on that
subnet. Fig 3. A security group configured to allow incoming SSH connections
(TCP port 22) from all instances on a given subnet.</p>
<p><img alt="A diagram representing SSH conections being allowed from a known subnet to instances within security group 1, while connections from a hacker at an IP address ouside the subet are denied" src="files/2023/ibm-cloud/3_allow-ssh-subnet.webp"></p>
<p><em>Fig 3. A security group configured to allow incoming SSH connections (TCP port
22) from all instances on a given subnet.</em></p>
<p>The diagram shows instances on an authorized subnet (deploy1 &amp; deploy2),
representing a project CI/CD infrastructure, all being able to make SSH
connections to our protected instances, for example to deploy updates to our
application. Other instances, such as an enterprising hacker, are blocked.</p>
<h3>Allow Application Instances to Access a Distributed Data Store</h3>
<p>Another use case would be to allow application servers to access the nodes of a
distributed data store. To do this, we'll make a few changes to the above
security group configuration.</p>
<p>Firstly, we modify the open port from SSH's 22, to MongoDB's default query API
port of 27017.</p>
<p>Secondly, security group 1 is now allowing the creation of outgoing network
connections, from our application instances, where previously it was allowing
incoming connections. Security group rules can manage traffic in either
direction.</p>
<p>Thirdly, we don't want our data store instances to be unprotected, so we'll put
them into a security group of their own. Since there's now two security groups,
we'll give them names: “app” and “db”.</p>
<p>For now, security group “db” allows all incoming MongoDB queries (TCP
connections on 27017), without restricting the IP addresses allowed to make
connections. We'll fix that soon. Fig 4. Two security groups configured to
allow application servers to send queries to MongoDB nodes on a subnet.</p>
<p><img alt='A diagram representing queries from instances in security group "app" being allowed to connect to port 27017 of the subnet of instances in security group "db", which similarly allows incoming connections on TCP port 27017' src="files/2023/ibm-cloud/4_allow-app-servers-access-db-subnet.webp"></p>
<p><em>Fig 4. Two security groups configured to allow application servers to send
queries to MongoDB nodes on a subnet.</em></p>
<p>For clarity, these diagrams don't show the many connections which are blocked
by this setup - which are, of course, the whole point of security groups.
On the above diagram, blocked connections would include:</p>
<ul>
<li>
<p>On app instances:</p>
<ul>
<li>All incoming connections.</li>
<li>Outgoing connections that aren't TCP, or are on the wrong port.</li>
<li>Outgoing connections to anything other than a DB instance.</li>
</ul>
</li>
<li>
<p>On DB instances:</p>
<ul>
<li>All outgoing connections.</li>
<li>Incoming connections that aren't TCP, or are on the wrong port.</li>
</ul>
</li>
</ul>
<p>This setup does have a couple of problems. It relies on our MongoDB instances
all residing on a single subnet. Worse, as mentioned earlier, it allows any IP
address in the world to make queries to MongoDB. We'll fix both of these next.</p>
<h3>Using Remote Groups to Specify Arbitrary IP Addresses</h3>
<p>Specifying allowed instances using a CIDR block can be inappropriate. It's
often preferable to specify a set of arbitrary IP addresses instead. We can do
this by using a second security group – known as a remote group – to contain
the set of allowed instances. Our first security group can then refer to the
remote group to specify which instances are allowed.</p>
<p>In our example above, we would modify the “app” security group by dropping the
CIDR block, and replacing it with a reference to “db” as a remote security
group.</p>
<p>Similarly, we would modify the “db” group to use “app” as a remote group, only
allowing connections from the members of that group. Fig 5. Two security groups
configured to allow application servers to send queries to MongoDB nodes using
remote groups.</p>
<p><img alt='A diagram representing instances in security group "app" being allowed to connect to instances in security group "db", via port 27017 only' src="files/2023/ibm-cloud/5_allow-app-servers-access-db-remote.webp"></p>
<p><em>Fig 5. Two security groups configured to allow application servers to send
queries to MongoDB nodes using remote groups.</em></p>
<p>This has several advantages. Firstly, our data store no longer accepts
malicious queries from hackers all over the internet – only from our app
instances.</p>
<p>Secondly, our data store instances no longer need occupy a subnet, they can
have arbitrary IP addresses.</p>
<p>Because the security groups now specify allowed hosts by referencing each
other, when the members of either group changes, the instance level firewalling
rules on all instances are updated automatically, to allow or deny traffic
based on the new membership.</p>
<p>This configuration starts to show what makes security groups a flexible,
dynamic, low-maintenance solution.</p>
<h3>Accepting Web Requests</h3>
<p>Our application instances aren't any use without a web front end. We put our
web instances into their own security group (“web”), which allows incoming
requests from users on the web, and outgoing API requests to our app instances,
on port 61516.</p>
<p>Similarly, we need to add a second rule to the “app” security group, to allow
incoming requests from “web”. Fig 6. A traditional three-tier application using
remote security groups.</p>
<p><img alt='A diagram representing a user connecting via port 80 to instances in security group "web", which connect to instances in group "app" via port 61516, which connect to group "db" via port 27017' src="files/2023/ibm-cloud/6_web-app-db.webp"></p>
<p><em>Fig 6. A traditional three-tier application using remote security groups.</em></p>
<p>The more types of server we add to our setup, the more benefit “remote” groups
provide, by minimizing setup configuration, and by automatically keeping
firewalling rules up to date when group membership changes.</p>
<p>A future blog post will discuss how to set up this three-tier scenario, and
describe details such as how to use multiple network interfaces on an instance,
such as the web instances which will use a public IP address exposed to users,
versus a private IP exposed to the API instances.</p>
<h3>Add a Bastion</h3>
<p>We need some way to access our servers, so that we can, for example, deploy new
versions of our application. Commonly this is achieved using a bastion server,
which provides a single, carefully hardened point of access.</p>
<p>Here we add a bastion server, and modify all our security groups to allow SSH
access from the bastion to all our instances. The bastion instance itself would
be configured to only allow incoming connections from the appropriate points in
a CI/CD infrastructure (not shown.) Fig 7. Adding a bastion server with SSH
access to all other instances.</p>
<p><img alt='A diagram representing the same elements as figure 6 above, with the addition of a "bastion" group which connects to all instances via SSH on port 22' src="files/2023/ibm-cloud/7_bastion.webp"></p>
<p><em>Fig 7. Adding a bastion server with SSH access to all other instances.</em></p>
<p>This is starting to look like a realistic setup for a modest but scalable
multi-tier application.</p>
<h3>Conclusion</h3>
<p>Security groups are a flexible and powerful way to firewall network traffic to
and from your system's instances. We've shown how they might be used in a few
typical scenarios, and hopefully demonstrated that they are flexible enough to
accommodate many others. For more information, see
<a href="https://cloud.ibm.com/docs/security-groups/sg_index.html">Getting Started with Security Groups</a>.</p>
<hr>
<p><span style="float: left">
<img alt="Jonathan Hartley's smiley face" src="files/2023/ibm-cloud/jonathan-hartley.webp"></span>
<br><strong>Jonathan Hartley</strong><br>
Senior Cloud Developer</p>
<p><span style="float: none"></span></p>
<p></p>
<p></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/til-git-push-force-with-lease/" class="u-url">TIL: git push --force-with-lease</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/til-git-push-force-with-lease/" rel="bookmark">
            <time class="published dt-published" datetime="2023-08-04T13:48:19-05:00" itemprop="datePublished" title="2023-08-04 13:48">2023-08-04 13:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Don't ever type <code>git push --force</code>. Yes, there are times we have to hold our
nose and do a force push. Maybe the project requires contributions to be
rebased or squashed. Maybe we pushed the nuclear launch codes. But there are
failure modes:</p>
<ul>
<li>You might be accidentally pushing to or from the wrong branch, and hence are
  about to blow away valuable work at the remote. Yes, is unlikely, and can be
  fixed after the fact, but who knows how much embarrassing disruption and
  confusion you'll cause the team before you realize what you did.</li>
<li>Do you <em>always</em> remember to check the state of the remote, to make sure there
  isn't unexpected extra commits on the remote that you'll unknowingly blow
  away when you push? Do you enjoy always having to type those extra commands
  to pull and check the remote commits?</li>
<li>No matter how conscientious we are about checking the above, there is a race
  condition. We might check the remote, then someone else pushes valuable
  changes, then we force push and blow them away.</li>
</ul>
<p>Although there are conventions that can help with all the above (e.g. only ever
force pushing to your own fork, to which nobody else ever pushes), they aren't
generally watertight. (e.g. you might have pushed something yourself, before
vacation, and forgotten about it.)</p>
<p>So the generally agreed method to avoid the above failure modes is "be more
careful", which sounds to me like the common prelude to failure. What we need
are push's newer command-line options:</p>
<dl>
<dt><code>--force-with-lease</code></dt>
<dd>Like <code>--force</code>, but refuses to push if the remote ref doesn't point at the
same commit that our local remote-tracking branch 'origin/mybranch' thinks it
should. So if someone else pushes something to the remote's 'mybranch' just
before we try to force push, our push will fail until we pull (and, in theory,
inspect) those commits that we were about to blow away.</dd>
</dl>
<p>It turns out that this is inadequate. One might have fetched an up-to-date remote
branch, but somehow or other ended up with our local HEAD on a divergent branch
anyway:</p>
<div class="code"><pre class="code literal-block">C origin/mybranch
|
B¹   B² HEAD mybranch
 \ /
  A
  |
</pre></div>

<p>In this situation, <code>--force-with-lease</code> will allow us to push, not only blowing
away the original commit B¹, as we intended, but also C, which was maybe pushed
by someone else before we fetched.</p>
<p>To guard against this, we can use the even newer option:</p>
<dl>
<dt><code>--force-if-includes</code></dt>
<dd>This makes <code>--force-with-lease</code> even more strict about rejecting pushes,
using clever heuristics on your local reflog, to check that the remote ref
being updated doesn't include commits which have never been part of your local
branch.</dd>
</dl>
<p>Upshot is, I plan to default to always replacing uses of <code>--force</code> with:</p>
<div class="code"><pre class="code literal-block">git<span class="w"> </span>push<span class="w"> </span>--force-with-lease<span class="w"> </span>--force-if-includes<span class="w"> </span>...
</pre></div>

<p>That's a lot to type, the options don't have short versions, and it's easy to forget to
do. Hence, shadow <code>git</code> to enforce it, and make it easy. In .bashrc or similar:</p>
<div class="code"><pre class="code literal-block"><span class="c1"># Shadow git to warn againt the use of 'git push -f'</span>
git<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">is_push</span><span class="o">=</span><span class="nb">false</span>
<span class="w">    </span><span class="nv">is_force</span><span class="o">=</span><span class="nb">false</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$arg</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"push"</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">is_push</span><span class="o">=</span><span class="nb">true</span>
<span class="w">        </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$arg</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"-f"</span><span class="w"> </span>-o<span class="w"> </span><span class="s2">"</span><span class="nv">$arg</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"--force"</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">is_force</span><span class="o">=</span><span class="nb">true</span>
<span class="w">    </span><span class="k">done</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$is_push</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$is_force</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="c1"># Suggest alternative commands.</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"git push -f: Consider 'git push --force-with-lease --force-if-includes' instead, which is aliased to 'gpf'"</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="c1"># Run the given command, using the git executable instead of this function.</span>
<span class="w">    </span><span class="k">$(</span>which<span class="w"> </span>git<span class="k">)</span><span class="w"> </span><span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
<span class="o">}</span>

<span class="c1"># git push force: using the new, safer alternatives to --force</span>
gpf<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1"># Older versions of git don't have --force-if-includes. Fallback to omitting it.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--quiet<span class="w"> </span>--force-with-lease<span class="w"> </span>--force-if-includes<span class="w"> </span><span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span>git<span class="w"> </span>push<span class="w"> </span>--quiet<span class="w"> </span>--force-with-lease<span class="w"> </span><span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>
</pre></div>

<p>Then trying to do it wrong tells you how to easily do it right:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>-f
git<span class="w"> </span>push<span class="w"> </span>-f:<span class="w"> </span>Consider<span class="w"> </span><span class="s1">'git push --force-with-lease --force-if-includes'</span><span class="w"> </span>instead,<span class="w"> </span>which<span class="w"> </span>is<span class="w"> </span>aliased<span class="w"> </span>to<span class="w"> </span><span class="s1">'gpf'</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>
$<span class="w"> </span>gpf
$
</pre></div>

<p>(The [1] is my prompt telling me that the last command had an error exit value.)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/structured-pattern-matching-in-python/" class="u-url">Structured Pattern Matching in Python</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/structured-pattern-matching-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-07-29T18:15:26-05:00" itemprop="datePublished" title="2023-07-29 18:15">2023-07-29 18:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I read through descriptions of
<a href="https://docs.python.org/3.11/reference/compound_stmts.html#the-match-statement">structured pattern matching</a>
when it was added in Python 3.10 a couple of years ago, and have studiously
avoided it ever since. It seemed like a language feature that's amazingly
useful in one or two places, like writing a parser, say, and is a horrifically
over-complicated mis-step just about everywhere else.</p>
<blockquote>
<p><strong>Update:</strong> A day after writing this I see that Guido van
Rossum wrote exactly that,
<a href="https://github.com/gvanrossum/patma/blob/master/examples/expr.py">a parser</a>,
to showcase the feature. I'm guessing he writes a lot of parsers. I definitely
don't write enough of them to think this language feature is worth the extra
complexity it brings.</p>
</blockquote>
<p>Regardless, I really ought to remember how it works, so this is my attempt to
make the details stick, by writing about it.</p>
<p>If you're not me, you really ought to be reading about it from the source instead:</p>
<ul>
<li>
<a href="https://peps.python.org/pep-0634/">PEP 643</a>: Specification.</li>
<li>
<a href="https://peps.python.org/pep-0635/">PEP 635</a>: Motivation and rationale.</li>
<li>
<a href="https://peps.python.org/pep-0636/">PEP 636</a>: A tutorial.</li>
</ul>
<h2>Basic structure</h2>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">EXPRESSION</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">PATTERN1</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="k">case</span> <span class="n">PATTERN2</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>

<p>This evaluates the <code>match</code> EXPRESSION, then tries to match it against each
<code>case</code> PATTERN, executing the body of the first case that matches, falling back
to the optional final <code>_</code> default case. (<code>match</code> and <code>case</code> are not keywords,
except in the context of a match...case block, so you can continue using them
as variable names elsewhere.)</p>
<p>But what are PATTERNs, and how are they tested for a match?</p>
<h2>Patterns</h2>
<p>Patterns can be any of the following. As becomes increasingly obvious down the
list, the real power of this feature comes from composing each of these
patterns with the others. For complicated patterns, parentheses can be used to
indicate order of operations.</p>
<h3>Literals</h3>
<p>Like other languages' traditional <code>switch</code> statement:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">mycommand</span><span class="p">:</span>
    <span class="k">case</span> <span class="s1">'start'</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="k">case</span> <span class="s1">'stop'</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CommandNotFoundError</span><span class="p">(</span><span class="n">mycommand</span><span class="p">)</span>
</pre></div>

<p>Such literal case patterns may be strings (including raw and byte-strings, but
not f-strings), numbers, booleans or None.</p>
<p>Such cases are compared with equality:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="mi">123</span><span class="p">:</span>
    <span class="k">case</span> <span class="mf">123.0</span><span class="p">:</span>
        <span class="c1"># matches!</span>
</pre></div>

<p>except for booleans and None, which are compared using <code>is</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="nc">Any</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="n">myfalse</span> <span class="o">=</span> <span class="n">Any</span><span class="p">()</span>

<span class="k">match</span> <span class="n">myfalse</span><span class="p">:</span>
    <span class="n">case</span> <span class="kc">False</span><span class="p">:</span>
        <span class="c1"># Doesn't match, even though myfalse == False</span>
        <span class="k">assert</span> <span class="kc">False</span>
</pre></div>

<h3>Variable names</h3>
<p>We can replace a literal with a variable name, to capture the value of the match
expression.</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">command</span><span class="p">:</span>
    <span class="k">case</span> <span class="s1">'start'</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="k">case</span> <span class="s1">'stop'</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="k">case</span> <span class="n">unknown</span><span class="p">:</span>
        <span class="c1"># New variable 'unknown' is assigned the value of command</span>
</pre></div>

<p>The 'default' case pattern <code>_</code> is just a special case variable name which
binds no name.</p>
<p>Beware the common error of using "constants" as the case pattern:</p>
<div class="code"><pre class="code literal-block"><span class="n">NOT_FOUND</span> <span class="o">=</span> <span class="mi">404</span>

<span class="k">match</span> <span class="n">error</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">NOT_FOUND</span><span class="p">:</span> <span class="c1"># bad</span>
        <span class="n">handle_404</span><span class="p">()</span>
</pre></div>

<p>The above case is intended to test for <code>error == NOT_FOUND</code>, but instead
assigns the variable <code>NOT_FOUND = error</code>. The best defense is to always include
a default catch-all case at the end, which causes the above <code>NOT_FOUND</code> case to
produce a SyntaxError:</p>
<div class="code"><pre class="code literal-block"><span class="n">NOT_FOUND</span> <span class="o">=</span> <span class="mi">404</span>

<span class="k">match</span> <span class="n">error</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">NOT_FOUND</span><span class="p">:</span>
        <span class="n">handle_404</span><span class="p">()</span>
    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>

<div class="code"><pre class="code literal-block"><span class="n">SyntaxError</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="s1">'NOT_FOUND'</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="n">patterns</span><span class="w"> </span><span class="n">unreachable</span>
</pre></div>

<p>To use a 'constant' in a case pattern like this, qualify it with a dotted name,
such as by using an <code>enum.Enum</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">error</span>
    <span class="k">case</span> <span class="n">errors</span><span class="o">.</span><span class="n">NOT_FOUND</span><span class="p">:</span>
        <span class="c1"># correctly matches</span>
</pre></div>

<h3>Sequences</h3>
<p>Using a list-like or tuple-like syntax, matches must have the right number of
items. Like Python's existing iterable unpacking feature. Use <code>*</code> to match the
rest of a sequence. Included variable names are set if a case matches by all
other criteria.</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">command</span><span class="p">:</span>
    <span class="k">case</span> <span class="p">(</span><span class="s1">'start'</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># New variable name=command[1]</span>
    <span class="k">case</span> <span class="p">(</span><span class="s1">'stop'</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># New variable name=command[1]</span>
    <span class="k">case</span> <span class="p">(</span><span class="s1">'stop'</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
        <span class="c1"># New variables name=command[1], delay=command[2]</span>
    <span class="k">case</span> <span class="p">(</span><span class="s1">'stop'</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="o">*</span><span class="n">extra</span><span class="p">):</span>
        <span class="c1"># New variables name=command[1], delay=command[2] &amp; extra=command[3:]</span>
    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadCommand</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</pre></div>

<h3>Mappings</h3>
<p>Using a dict-like syntax. The match expression must must contain a
corresponding mapping, and can contain other keys, too. Use <code>**</code> to match the
rest of a mapping.</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">config</span><span class="p">:</span>
    <span class="k">case</span> <span class="p">{</span><span class="s1">'host'</span><span class="p">:</span> <span class="n">hostname</span><span class="p">}:</span>
        <span class="c1"># 'config' must contain key 'host'. New variable hostname=config['host']</span>
    <span class="k">case</span> <span class="p">{</span><span class="s1">'port'</span><span class="p">:</span> <span class="n">portnumber</span><span class="p">}:</span>
        <span class="c1"># 'config' must contain key 'port'. New variable portnumber=config['port']</span>
        <span class="c1"># Remember we only use the first matching case.</span>
        <span class="c1"># If 'config' contains 'host', then this 'port' case will not match.</span>
    <span class="k">case</span> <span class="p">{</span><span class="s1">'scheme'</span><span class="p">:</span> <span class="n">scheme</span><span class="p">,</span> <span class="o">**</span><span class="n">extras</span><span class="p">}:</span>
        <span class="c1"># new variables 'scheme' and 'extras' are assigned.</span>
</pre></div>

<p>Case patterns may contain more than one key-value pair. The match expression must
contain all of them to match.</p>
<div class="code"><pre class="code literal-block">    <span class="k">case</span> <span class="p">{</span>
        <span class="s1">'host'</span><span class="p">:</span> <span class="n">hostname</span><span class="p">,</span>
        <span class="s1">'port'</span><span class="p">:</span> <span class="n">portnumber</span><span class="p">,</span>
    <span class="p">}:</span>
        <span class="o">...</span>
</pre></div>

<h3>Objects and their attributes</h3>
<p>Using class syntax, the value must match an isinstance check with the given class:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">event</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">Click</span><span class="p">():</span>
        <span class="c1"># handle click</span>
        <span class="o">...</span>
    <span class="k">case</span> <span class="n">KeyPress</span><span class="p">():</span>
        <span class="c1"># handle key press</span>
        <span class="o">...</span>
</pre></div>

<p>Beware the common error of omitting the parentheses:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">myval</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">Click</span><span class="p">:</span> <span class="c1"># bad</span>
        <span class="c1"># handle clicks</span>
</pre></div>

<p>The above case is intended to test for <code>isinstance(myval, Click)</code>, but instead
creates a new var, <code>Click = myval</code>. The best defence against this error is to
always include a default catch-all at the end, which makes the <code>Click</code> catch-all
produce an error by making subsequent patterns unreachable.</p>
<p>Attribute values for the class can be given, which must also match.</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">event</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">KeyPress</span><span class="p">(</span><span class="n">key_name</span><span class="o">=</span><span class="s1">'q'</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">game</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
    <span class="k">case</span> <span class="n">KeyPress</span><span class="p">():</span>
        <span class="n">handle_keypress</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</pre></div>

<p>Values can also be passed as positional args to the class-like case syntax:</p>
<div class="code"><pre class="code literal-block">    <span class="k">case</span> <span class="n">KeyPress</span><span class="p">(</span><span class="s1">'q'</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="o">...</span>
</pre></div>

<p>If the class is a namedtuple or dataclass, then positional args to a class-like
case pattern can automatically be handled using the unambiguous ordering of its
attributes:</p>
<div class="code"><pre class="code literal-block"><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s1">'dash'</span><span class="p">,</span> <span class="s1">'golden'</span><span class="p">)</span>

<span class="k">match</span> <span class="n">d</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">Dog</span><span class="p">(</span><span class="s1">'dash'</span><span class="p">,</span> <span class="s1">'golden'</span><span class="p">):</span>
        <span class="c1"># matches</span>
</pre></div>

<p>But for regular classes, the ordering of the class attributes is ambiguous.
To fix this, add a <code>__match_args__</code> attribute on the class, a tuple which
specifies which class attributes, in which order, can be specified in a case
pattern:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="nc">KeyPress</span><span class="p">:</span>
    <span class="n">__match_args__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'key_name'</span><span class="p">,</span> <span class="s1">'release'</span><span class="p">)</span>

<span class="n">event</span> <span class="o">=</span> <span class="n">KeyPress</span><span class="p">(</span><span class="n">key_name</span><span class="o">=</span><span class="s1">'q'</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">match</span> <span class="n">event</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">KeyPress</span><span class="p">(</span><span class="s1">'q'</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="c1"># matches!</span>
</pre></div>

<p>As you might expect, the literal positional args can be replaced with variable
names to capture attribute values instead:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">event</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">KeyPress</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span> <span class="c1"># names unimportant, order matters</span>
        <span class="n">handle_keypress</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>

<p>Positional sub-patterns behave slightly differently for builtins <code>bool</code>,
<code>bytearray</code>, <code>bytes</code>, <code>dict</code>, <code>float</code>, <code>frozenset</code>, <code>int</code>, <code>list</code>, <code>set</code>,
<code>str</code>, and <code>tuple</code>. A positional value is matched by equality against the match
expression itself, rather than an attribute on it:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="mi">123</span><span class="p">:</span>
    <span class="k">case</span> <span class="nb">int</span><span class="p">(</span><span class="mi">123</span><span class="p">):</span>
        <span class="c1"># matches</span>
    <span class="k">case</span> <span class="nb">int</span><span class="p">(</span><span class="mf">123.0</span><span class="p">):</span>
        <span class="c1"># would also match if it wasn't shadowed</span>
</pre></div>

<p>Similarly, a positional variable is assigned the value of the match expression
itself, not an attribute on that value:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="mi">123</span><span class="p">:</span>
   <span class="k">case</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="o">...</span>

<span class="k">assert</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">123</span>
</pre></div>

<p>The values passed as keyword or positional args to class-like case patterns can
be more than just literals or variable names. In fact they can use <em>any</em> of the
listed pattern types. For example, they could be a nested instance of this
class-like syntax:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="nc">Location</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>

<span class="k">class</span> <span class="nc">Car</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span>

<span class="n">mycar</span> <span class="o">=</span> <span class="n">Car</span><span class="p">(</span><span class="n">Location</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>

<span class="k">match</span> <span class="n">mycar</span><span class="p">:</span>
    <span class="k">case</span> <span class="n">Car</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="n">Location</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">))):</span>
        <span class="c1"># matches, and captures 'x' and 'y'</span>

<span class="k">assert</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">11</span>
<span class="k">assert</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">22</span>
</pre></div>

<h3>Combine patterns using <code>|</code>
</h3>
<p>To match either one pattern or another:</p>
<div class="code"><pre class="code literal-block">    <span class="k">case</span> <span class="mi">1</span> <span class="o">|</span> <span class="kc">True</span> <span class="o">|</span> <span class="s1">'true'</span> <span class="o">|</span> <span class="s1">'on'</span> <span class="o">|</span> <span class="s1">'yes'</span><span class="p">:</span>
        <span class="c1"># matches any of those values</span>
</pre></div>

<h3>Capture sub-patterns using <code>as</code>
</h3>
<p>We've seen how we can either match against a value, or capture the value using
a variable name. We can do both using <code>as</code>:</p>
<div class="code"><pre class="code literal-block">    <span class="k">case</span> <span class="s1">'a'</span> <span class="o">|</span> <span class="s1">'b'</span> <span class="k">as</span> <span class="n">ab</span><span class="p">:</span>
        <span class="c1"># matches either value, captures what the value actually was</span>
</pre></div>

<p>This might not be much use when capturing the whole match expression like that.
If the match expression is just a variable, then we could instead simply refer
to that variable. But using <code>as</code> can be useful when the match expression is
lengthy or has side-effects:</p>
<div class="code"><pre class="code literal-block"><span class="k">match</span> <span class="n">events</span><span class="o">.</span><span class="n">get_next</span><span class="p">():</span>
    <span class="k">case</span> <span class="n">KeyDown</span><span class="p">()</span> <span class="k">as</span> <span class="n">key_event</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>

<p>or to capture just a component of the whole expression. Contrived example:</p>
<div class="code"><pre class="code literal-block">    <span class="k">case</span> <span class="p">(</span><span class="s1">'a'</span> <span class="o">|</span> <span class="s1">'b'</span> <span class="k">as</span> <span class="n">ab</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">):</span>
        <span class="c1"># matchs ['a', 'c'] or ['b', 'c'], and captures the first letter in 'ab'</span>
</pre></div>

<h4>An <code>if</code> guard clause</h4>
<p>Add arbitrary conditions to the match:</p>
<div class="code"><pre class="code literal-block">    <span class="k">case</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="c1"># matches integers less than 100</span>
</pre></div>

<p>Or, alternatively:</p>
<div class="code"><pre class="code literal-block">    <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="k">as</span> <span class="n">i</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="c1"># matches integers less than 100</span>
</pre></div>

<h2>Complications</h2>
<p>This feature seems rife with complexity. The flexible syntax of case patterns
forms a new mini-language, embedded within Python. It has many similarities to
Python, but also many initially unintuitive differences.</p>
<p>For example, a class-like case pattern such as <code>case Click():</code>. Anywhere else
in the language, the expression like <code>Click(...)</code> would create an instance of the
<code>Click</code> class. In a case statement, it instead is doing things like
<code>isinstance</code> and <code>hasattr</code> checks.</p>
<p>Similarly, including variable names doesn't return the variable value as in
ordinary Python. Instead it binds a value as that name. This is the source of
the annoying gotcha described above, that bare "constants" like <code>NOT_FOUND</code>
behave very unexpectedly when used as case expressions.</p>
<p>There are a few places in real-world code where structured pattern matching
will produce nicer code than the equivalent using nested <code>elif</code>s. But equally,
there are a lot of places where the <code>elif</code>s are a more natural match.
Developers now get to choose which they're going to use, and then later
disagree with each other about it, or simply change their mind, and end up
converting code from one to the other.</p>
<p>If this was a simple feature, with low overheads, then I'd forgive its
inclusion in the language, accepting the costs in return for the marginal and
unevenly distributed benefits.</p>
<p>But it's really not simple. In addition to Python programmers all having to
do an exercise like this post just to add it to their mental toolbox, it needs
maintenance effort, not just in CPython but in other implementations too, and
needs handling by tools such as syntax highlighters, type checkers. It really
doesn't seem like a net win to me, <em>unless</em> you're writing way more parsers
than the average programmer, which no doubt the champions of this feature are.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ur-fascism/" class="u-url">Ur-Fascism</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/ur-fascism/" rel="bookmark">
            <time class="published dt-published" datetime="2023-07-11T19:41:42-05:00" itemprop="datePublished" title="2023-07-11 19:41">2023-07-11 19:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><span style="float: left">
<img alt="Ur-Fascism cover" src="files/2023/ur-fascism-cover.webp"></span></p>
<p><em>by Umberto Eco, 1995.</em></p>
<p>Eco's prose has left me in the dust on occasion in the past. I missed so many references, or failed to keep up with the relentlessly nested layers of meaning, that I was simply holding on for the ride. This essay matches Eco's characteristically dense, intellectual prose, studded with foreign phrases, and references to contemporary thinkers, historical movements and causes and revolutions and dictatorships, and their antecedents. But it is short, and perhaps in contrast to the flourishes of brilliance that comprise his fiction, this is a factual piece, and is written to be understood rather than to dazzle. It begins by establishing Eco's credentials to speak on this topic, with the first of several entrancing first-hand indications of what it was like to grow up as an intellectual young child in Italy under Mussolini, and the revelations that followed at the opening up of his world at the end of WWII.</p>
<p>He differentiates between the truly totalitarian fascism of, say, Nazism, which subordinated all of life to the state, with the looser, less coherent Italian fascism, noting that this did not derive from any increment of tolerance, merely the absence of a sufficiently encompassing underlying philosophy. Despite this, it is the Italian mode, which was the first right wing dictatorship in modern history, from which subsequent dictators seem to have drawn most stylistic inspiration, and from which our generic term of "fascism" derives.</p>
<p>The last half of the essay describes how fascism means different things in different contexts, but the various incarnations through history have exhibited sufficiently overlapping sets of symptoms as to glean a family resemblance. Eco enumerates 13 identifying traits, noting that the presence of even one of them can be sufficient to allow fascism to coagulate around it. Mostly for my own benefit, (with my own parenthesised observations) they are, briefly:</p>
<ol>
<li>
<p>Fascism incorporates a cult of tradition. This can be deployed as an automatic refutation of any undesirable new ideas, enshrining in their place the immutable wisdom of a mythical past. In addition, traditionalism undermines the perceived value of learning in itself - pre-emptively thwarting troublesome intellectuals. This anti-intellectual received wisdom, in order to provide whichever justifications are required of it, requires the syncretistic combination of various ancient beliefs. As a result it must tolerate contradictions. Indeed, the more stark they are, the better they serve the purpose of selecting followers who will obediently think whatever they are told.</p>
</li>
<li>
<p>The rejection of modernism. This is a powerful recruiting tool, enabling the fascist to leverage any dissatisfaction of the populous, laying claim to the emotionally appealing universal solution of a regression to simpler, happier times, while simultaneously rewinding societal progress in equality or liberty. While Nazis and fascists love their technology, this is a superficial tool, used in support of a deeply regressive project, namely the restoration of power to those with the strength and the will to take it. This irrationality goes hand in hand with anti-intellectualism.</p>
</li>
<li>
<p>Value vigor and action above reflection. Thinking is emasculation. Culture is suspect insofar as it aligns with any sort of critical theory or values. Regard centers of analysis or learning such as libraries or universities with suspicion for harboring - or even indoctrinating - people of opposing political viewpoints. Again, this is deeply intertwined with (1) &amp; (2), and its prevalence pre-emptively defuses any kind of mainstream understanding or critique.</p>
</li>
<li>
<p>All of the above make it inevitable that any given fascist regime will be rife with internal contradictions.  While modernity achieves its intellectual prowess through the nurturing of diverse thought, fascism cannot possibly withstand any critical analysis. Hence, disagreement is treason.</p>
</li>
<li>
<p>The fascist appeal to popularity exploits and exacerbates the natural fear of <em>the other</em>, and hence is always inherently racist. Expect demonization of immigrants, foreigners, other nation states, as well as other marginalized groups, taking advantage of whatever local contemporary biases and fears might be present.</p>
</li>
<li>
<p>The above exploitation takes the form of an appeal to the frustrations of the middle class - or whichever class can be most useful and readily mobilized by persuasion that their problems are caused by some identifiable other.</p>
</li>
<li>
<p>Modernity genuinely does disintegrate traditional social bonds, along with sources of identity and meaning. Fascism's solution to this is to unify the disaffected under the only remaining banner common to them all, that of patriotism and nationalism. This unity is strengthened by emphasis on the country's enemies, and especially by conspiracy theories of secret international plots against the nation. Followers must feel besieged (as Trump advised the January 6th crowd that "America is under siege"). Eco makes special mention, in the U.S, of Pat Robertson's <em>The New World Order</em>, but potential sources of conspiracy are innumerable.</p>
</li>
<li>
<p>Followers can be riled into frenzy of humiliation at their enemies' wealth or power. Jews control the
world and its money. Instead of coastal liberals, refer to coastal elites. But at the same time, the instinct to action requires that enemies can easily be defeated. Hence enemies are simultaneously too weak and too strong. Herein lies one of fascism's greatest weaknesses, responsible for several lost wars, in that it is constitutionally incapable of objectively assessing an enemy's strength.</p>
</li>
<li>
<p>Goad followers into violent action with rhetoric not just of a struggle for survival, but by declaration that life is struggle, and hence pacifism is conspiring with the enemy.</p>
</li>
<li>
<p>While fascism appeals for the participation of the population by promising empowerment for the majority, its naked power lust is a fundamentally aristocratic endeavor. The leader takes power from those too weak to oppose  him, disdaining both conquered rivals and the subjugated population. Power struggles within the Party are vicious, and the party rides roughshod over the citizens, who likewise are leagues above the disenfranchised. The hierarchy is strict, steep, and ruthless. Elitism abounds, as does fear of losing one's status.</p>
</li>
<li>
<p>The redress of modernity's threadbare social fabric, by emphasizing nationalism and strength, further erodes interpersonal solidarity. Each individual must becomes their own hero. Strong, independent, and utterly without recourse in times of need. The cult of the hero is intimately entwined with a cult of death. Having only the narrow causes of the nation and the Party to live for, the hero yearns for a heroic death - or, better, to demonstrate their power and status by sending others to their death.</p>
</li>
<li>
<p>The preeminent will to power, so often frustrated in an aristocratic, dog-eat-dog social order, manifests alternately in things like machismo, disdain for women, and phallic fetishization of weapons. Repressed insecurity breeds an outward contempt for unconventional sexuality, including chastity.</p>
</li>
<li>
<p>Under fascism, the people have no innate rights, and hence no material preferences or expression. Instead, the leader pretends to interpret the Will of the People. This charade requires the party apparatus to select and amplify some emotional response of the people, and present it as representative, so that the party can be empowered to act on behalf of that supposedly majority. Consider the amplifications of manufactured outrage about culture war issues, so that elected representatives are empowered to act decisively on their own preferences, against the majority of the population's wishes. This leads directly to confrontation with institutions such as a parliament. Fascism will therefore cast aspersions on any properly functioning parliament's legitimacy.</p>
</li>
<li>
<p>All fascisms make use of their own varieties of NewSpeak, using an impoverished vocabulary and syntax, in order to limit the instruments for critical reasoning. This may appear in apparently innocent forms, from schoolbooks to popular talk shows.</p>
</li>
</ol>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/makefiles-that-are-self-documenting-and-process-all-extant-files/" class="u-url">TIL: Makefiles that are self-documenting, and process all extant files.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/makefiles-that-are-self-documenting-and-process-all-extant-files/" rel="bookmark">
            <time class="published dt-published" datetime="2023-07-06T11:50:16-05:00" itemprop="datePublished" title="2023-07-06 11:50">2023-07-06 11:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <h3>Self-documenting Makefiles</h3>
<p>A trick from years ago, but I copy it around between projects enough that it
deserves calling out. Add a target:</p>
<div class="code"><pre class="code literal-block"><span class="nf">help</span><span class="o">:</span><span class="w"> </span><span class="c">## Show this help.</span>
<span class="c">    @# Optionally add 'sort' before 'awk'</span>
<span class="w">    </span>@grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">'^[a-zA-Z_\.%-]+:.*?## .*$$'</span><span class="w"> </span><span class="k">$(</span>MAKEFILE_LIST<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-10s\033[0m %s\n", $$1, $$2}'</span>
<span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">help</span>
</pre></div>

<p>Decorate other targets with a descriptive '##' comment, like "<em>Show this help</em>"
above. Now calling the 'help' target will summarize all the things the Makefile
can do. eg:</p>
<div class="code"><pre class="code literal-block">$ make help
help       Show this help.
setup      Install required system packages using 'apt install'.
%.pdf      Generate given PDF from corresponding .tex file.
all        Convert all .tex files to PDF.
</pre></div>

<p>You might choose to make 'help' the first target in the Makefile, so that it
gets triggered when the user runs <code>make</code> without arguments.</p>
<h3>Process all extant files</h3>
<p>Make's canonical paradigm is that you tell it the name of the file to generate,
and it uses the tree of dependencies specified in the Makefile to figure out
how to build it. Typically you'll use automatic variables like "$&lt;" to represent
the wildcarded source filename:</p>
<div class="code"><pre class="code literal-block"><span class="nf">%.pdf</span><span class="o">:</span><span class="w"> </span>%.<span class="n">tex</span> <span class="c">## Generate given PDF from corresponding .tex file.</span>
<span class="w">    </span>pdflatex<span class="w"> </span>$&lt;
</pre></div>

<p>The pitfall is that when invoking this, you have to name all the PDF files you
want to generate. If the names are a fixed part of your build, they can be
embedded in the Makefile itself:</p>
<div class="code"><pre class="code literal-block"><span class="nf">all</span><span class="o">:</span><span class="w"> </span><span class="n">one</span>.<span class="n">pdf</span> <span class="n">two</span>.<span class="n">pdf</span> <span class="n">three</span>.<span class="n">pdf</span>
</pre></div>

<p>But if their names are dynamic, you have to specify them on the command line,
which is a pain:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>make<span class="w"> </span>one.pdf<span class="w"> </span>two.pdf<span class="w"> </span>three.pdf
</pre></div>

<p>This is easy enough when <em>re-</em>generating all the PDFs that already exist:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>make<span class="w"> </span>*.pdf
</pre></div>

<p>but is no help when you just have a bunch of .tex files and you just want Make
to build all of them. This is going the opposite way to canonical make usage.
We want to specify the existing source files (<code>*.tex</code>, in this case), and have
Make build the resulting products.</p>
<p>To do it, we need our Makefile to enumerate the existing source files:</p>
<div class="code"><pre class="code literal-block"><span class="nv">TEX_FILES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">$(</span>wildcard<span class="w"> </span>*.tex<span class="k">)</span>
</pre></div>

<p>Using the 'wildcard' function here behaves better than a bare wildcard
expansion, e.g. it produces no output when there are no matches, rather than
outputting the unmatched wildcard expression.</p>
<p>Then use a substitution to generate the list of .pdf filenames:</p>
<div class="code"><pre class="code literal-block"><span class="nv">all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">$(</span>TEX_FILES:%.tex<span class="o">=</span>%.pdf<span class="k">)</span>
</pre></div>

<p>Now <code>make all</code> will generate one .pdf file for each extant .tex file, regardless of
whether the corresponding .pdf files already exist or not.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/astroneer-resource-graph/" class="u-url">Astroneer Resource Graph</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/astroneer-resource-graph/" rel="bookmark">
            <time class="published dt-published" datetime="2023-04-11T10:01:51-05:00" itemprop="datePublished" title="2023-04-11 10:01">2023-04-11 10:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Used the trusty <a href="https://graphviz.org/">Graphviz</a> to whip up a diagram showing how to
get each of the resources in <a href="https://astroneer.space/">Astroneer</a>. Click the WEBP
thumbnail below to get the full glorious SVG, then you can '<em>find in page</em>' on it.
(<a href="files/2023/astroneer/astroneer-resources-graph.dot">Diagram source</a>)</p>
<p><a href="files/2023/astroneer/astroneer-resources-graph.svg"><img alt="Astroneer Resource Graph" src="files/2023/astroneer/astroneer-resources-graph-thumb.webp"></a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/soma/" class="u-url">Soma</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/soma/" rel="bookmark">
            <time class="published dt-published" datetime="2022-10-04T13:51:16-05:00" itemprop="datePublished" title="2022-10-04 13:51">2022-10-04 13:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><em>by Frictional Games, published 2015</em>
<img alt="Spoilers" src="files/spoilers.svg"></p>
<p>Major spoilers ahead. It's seven years old at this point.</p>
<p></p>
<center>
<img alt="Soma - protagonist" src="files/2022/soma-protagonist.webp">
</center>
<br><p>Soma is a creepy survival horror game, that leans deeply into the moral and
existential quandaries arising from the deterministic principle that it's
possible to scan one's brain and copy the structure into some other substrate,
yielding a second conscious entity, which thinks it is you. So there are deep
science-fiction issues in play here, about whether we think such a scheme could
ever possibly work, and about the practical, personal, and societal
ramifications of it.</p>
<p>I loved the setup. A humdrum morning begins in your present-day Toronto
apartment. A note on the fridge reminds you that today is the day of your
medical appointment, a brain scan. Reaching the doctor's office by train, you
find the experimental new type of brain scanner, run by some PhD in a
cable-strewn side-office. Sit in the chair, don the helmet, wait for the scan
to complete and- blink! Suddenly, you are elsewhere.</p>
<p>As the game progresses, it becomes obvious that the version of you that sat
down in the seat did not experience this discontinuity. They completed the
scan, removed the helmet, and continued their normal, everyday life.</p>
<p>You are not that copy. You open your eyes to a grim, decrepit cyberpunk future.
Exploring, your only company is a menagerie of half-functional robots and
drones, many of which are insane, and, in conversation, seem to be under the
impression that they are human beings. It gradually becomes apparent that
perceptual filters are in play, preventing them - and you - from noticing they
are no longer human. At one point the ocean crashes in on you, and you drown
for a little while, or at least think you are, but you still don't die. At that
point you have to acknowledge the truth.</p>
<p>You have awoken to the year 2104, and the recorded brain scans of real humans
are being used to animate drones. This is a scenario much like that told from a
different perspective in the smashing short story
<a href="https://qntm.org/mmacevedo"><em>Lena</em></a> by qntm.
Failing systems engaged fall-backs, resulting in your obsolete brain scan being
yanked from storage to inhabit an advanced humanoid robot, in a facility deep
under the ocean, some time after a comet strike has scoured all life from the
planet's surface.</p>
<p>If that wasn't bad enough, one facilitating technology of this nightmarish
scenario, a black goo that mimics and improves upon electrical and biological
circuitry it comes into contact with, has run rampant, growing probing tendrils
which are wrecking the facility. Among other effects, it has reanimated the
corpses of the last few humans, who skulk around, not in a good way. As our
protagonist asks, incredulously, "You mean they've been brought back to life?".
Our reassuring AI companion replies "Yeah, let's call it that."</p>
<p>The game borrows the highly effective mechanics of Frictional's previous games,
the Amnesia and Penumbra series, where the proximity of horrific, shambling
enemies causes your character to experience debilitating symptoms, including,
in this case, static-y visual distortions as your neural hardware suffers from
some overload or interference. This applies even if you simply look at an
enemy, an act which immediately draws their attention. So your only chance to
survive encounters is to stay well out of sight, and actively avert your eyes
so you can't even watch what's going on. Not being able to see exactly what
your enemies are, or what they are up to, turns out to be fabulously scary and
atmospheric. At one point it lead directly to my wife catching me staring
intently at a blank, black screen for a prolonged period, with a peculiar
expression on my face, as I hid in a dark cupboard waiting for the slithering
sounds behind me to go away.</p>
<p>Spurring us through this environment are not just threats to our immediate
survival, but also the adoption of a project, to launch into space a
solar-powered simulation, hosting all the last remaining brain scans of the
now-defunct human race, known as the 'ARK'. This will allow the on-board sims
to live a prolonged period of idyllic virtual existence, preserving at least
some echo of what humanity was. Since the conceit of the game is that our
character is a living and conscious entity that feels real emotion, the sims on
the ARK are all presumably the same, so this seems like a worthwhile endeavor.</p>
<p>We are guided, motivated, and assisted by "Catherine", a simulated personality
running on our hand-held omni-tool, based on the brain recording of an AI
researcher, whose project during her lifetime was the ARK. Plugging her in to a
wall or console socket lets her interface with our surroundings, activating
power supplies and manipulating machinery. She leads us through a series of
undersea facilities, linked by trains, submersibles, and the occasional
disorienting trudge across the murky ocean floor, stirred up by ferocious
currents and landslides, populated by organic-mechanical hybrid horrors that
glide by in the darkness. I found these some of the absolute best, most
atmospheric "walking simulator" moments I've experienced in a game.</p>
<p></p>
<center>
<img alt="The ocean floor, stirred up by currents and landslides" src="files/2022/soma-murky.webp"><br>Is that another distant light up ahead? Good luck finding them while the currents pummel you,
and hideous, deadly beasts loom out of the murk.
</center>
<br><p>Along the way, we encounter a few unforgettable scenarios. We come across the
failing storage system in which the last remaining copy of our own brain scan
resides. I decide to flip some buttons which delete it, prompting my character
to respond with something like "Let this be the last time I wake up in this
godforsaken place."</p>
<p>At another point, we find ourselves trapped within a collapsing facility on the
bottom of the ocean, with the gibbering undead hammering on the door from the
next room. There is an airlock leading out into the ocean, but we would be
crushed at this depth. There is no way out. Luckily, Catherine is able to guide
us into assembling a more robust robot, one capable of withstanding the
pressure - all we have to do is sit in the chair and activate the transfer into
it. We already did this once, back in Toronto. Easy.</p>
<p>Except, after the transfer, we glance back across the lab at our original - the
pictured chap with red LED eyes - who, we notice, is still breathing. Asking
Catherine about it, she reminds us that the brain scan is not a destructive
operation. He's still in there, chemically subdued for the moment, but he'll
soon wake up again, wondering why the transfer didn't work. So we are left with
the option of stomping out of the airlock to safety, leaving him behind to his
nightmarish fate. Or flipping a switch to deactivate him before we go.</p>
<p>A lot of these narrative beats work better as a game than they perhaps might in
a written story. They emphasize the player's complicity, your moral
culpability, which is a mode that games, for all their faults, can do better
than any other media. Plenty of the lesser moments along the way expose the
player to decisions about unplugging some human simulation or other which
declares itself to be "alive", but which is gating your progress in some way.
Some of them are yourself. Some of these acts require manhandling weighty
cables, which require large, insistent tugging with the mouse controls. It's
not just a disembodied button press. One has to provide a determined,
definitive, mechanical input to end a life. In context, the guilt feels real.</p>
<p>Later in the journey, we finally stumble across an honest-to-goodness real,
live human being. She describes how the rest of the humans will be gathered in
particular locations, while she stayed to protect the ARK. But, we tell her, we
just passed through those locations, and there were no humans remaining there.
We both know that the planet's surface is sterile. A beat passes before she
announces "So I'm the last human being left alive." She's deathly sick, and
without hope. By the end of your interactions she asks you to turn off her
life-support before you leave, and stay with her for her last wheezing moments.
So this is how humanity ends.</p>
<p>Carrying on, because what else is there to do? We finally we get the ARK loaded
into the launch system that delivers it to orbit, upload our brain scans onto
it just before it launches, and - we've done it! Success!</p>
<p>There was a moment, about five minutes before the end, when I realized what was
going to happen here, even though my character had not. It was a real emotional
blow. I envied and pitied him for his naive hope. For believing there was still
a way out. For, of course, the ARK's launch changed nothing for us. Our
simulations are aboard it, but we are still sitting here, in a broken robot
corpse in a collapsing facility at the bottom of a haunted ocean on a dead
planet. The dispatched copy will enjoy life on the ARK, but we - like the copy
of ourselves we left behind earlier - are stuck here for good. Roll credits.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/doomsday-clock/" class="u-url">Doomsday Clock</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/doomsday-clock/" rel="bookmark">
            <time class="published dt-published" datetime="2022-09-22T20:57:55-05:00" itemprop="datePublished" title="2022-09-22 20:57">2022-09-22 20:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><em>By Geoff Johns (writer), Gary Frank (pencil) &amp; Brad Anderson (colors). (2017-2019)</em>
<img alt="Spoilers" src="files/spoilers.svg"></p>
<p>The original <a href="https://archive.org/details/Watchmen1987"><em>Watchmen</em></a> is a
seminal 12-issue superhero comic by Alan Moore (writer) &amp; Dave Gibbons
(artist), published from 1986 to 1987, that transformed the comics world. A
superhero tale in which all-but-one of the superheroes have no superhuman
powers at all.</p>
<p>The decades since have spawned a number of remakes, sequels, prequels and
spin-offs. Zach Snyder's movie adaptation has its adherents, and the HBO
miniseries sequel was, in my opinion, excellent. But other than that they have
not been very good. I initially thought the 12 issue sequel <em>Doomsday Clock</em>
comic would fall solidly into this group, and passed it by when it came out
a couple of years ago.</p>
<p>But on reading it last week, I really enjoyed it. It really swings for the
fences, providing a smashing tale, with good arcs for both old and new
characters, and a genuine attempt to advance the conversation that <em>Watchmen</em>
started by deconstructing the superhero.</p>
<p>We last saw Dr Manhattan at the end of <em>Watchmen</em>, having been isolated from
humanity by Adrien Veidt's plans, tired of his entanglement in the messy
complexity of people's lives, threatening to leave the galaxy "for one less
complicated".</p>
<p></p>
<center>
<img alt="Manhattan's departure at the end of Watchmen" src="files/2022/doomsday-clock-watchmen-manhattan.webp">
</center>
<br><p>In <em>Doomsday Clock</em>, Adrian Veidt, genius that he is, invents a means to follow
Dr Manhattan, seeking his help with the re-emergence of imminent nuclear war
brought about by the revelations in Rorschach's journal, and it becomes clear
that the "simpler place" Dr Manhattan has journeyed to is the DC universe,
populated by Superman, Batman, and the <em>whole</em> stable of DC heroes.</p>
<p>Various other <em>Watchmen</em> characters make their way, or are transferred to, the
DC universe. This has been described across the comic industry as "the
crossover event nobody wanted", but personally I felt it was really well done.</p>
<p>Two of the most prominently deceased <em>Watchmen</em> characters are brought back
into play, using mechanisms I thought were legitimate and, on occasion,
laugh-out-loud satisfying as they reached their resolution.</p>
<p></p>
<center>
<img alt="Doomsday Clock Watchmen Comedian Alive" src="files/2022/doomsday-clock-comedian.webp">
</center>
<br><p>In particular, they find a way to bring back Rorschach. Or, at least, <em>a</em>
Rorschach. Another individual picks up the mask. This seems like the most
controversial of the many decisions in the book, but it's handled deftly, and
there are both similarities and differences between the old and the new
Rorschach, making it an interesting character in its own right. In some ways
this transformation is reminiscent of HBO Watchmen's treatment of Hooded
Justice - retaining everything we already knew about the character, but
performing an astonishing piece of narrative ju-jitsu to utterly transform
everything about what that meant.</p>
<p>The DC heroes slowly realize their world is being altered by Dr Manhattan's
manipulations, tying this crossover into the latest of the DC universe's
"crisis" events, as Manhattan experiments with this reality, in order to
understand it. In doing so, he uncovers deep truths that affect the
inter-relationship between all the DC time-lines and universes, establishing
that historical stories, such as Superman's original appearance in Action
Comics of the 1930s, represent realities that still exist, out in the
multiverse, unaffected by subsequent commercial re-ploughing that forever
drives Superman's origin story further forward in time over the years. All
these worlds, including the various DC pre-crisis worlds, are accessible to
Manhattan's powers.</p>
<p>Incidentally, this enables DC to undo the changes wrought by the last few
years' unpopular "New 52" era. This meant nothing to me when I started reading,
I know basically nothing about American comics, only being familiar with the
fabulous British <em>2000AD</em>. I was spurred into reading around the DC lore, and by
the time I was done, I understood that the <em>New 52</em> reality included things
like The Justice League's alternate roster, the early death of Clark's parents,
which distances Superman from humanity and changes the character dramatically,
the loss of the Justice Society of America from Earth, and the loss of Wally
West's Flash. All these and more are written off as the effects of Dr
Manhattan's meddling, isolated and preserved in just another spun-off part of
the multiverse, while being jettisoned from the privileged <em>metaverse</em>, the
core template from which all subsequent multiversal threads are forged, as it
reverts to more-or-less its former state when Manhattan's changes are undone
during <em>Doomsday Clock</em>'s story.</p>
<p>In doing all this, Manhattan exhibits his usual clinical detachment from the
human consequences of his actions, setting himself up as the villain of the
piece, an uncaring "being of inaction", in contrast to Superman, the literal
"man of Action".</p>
<p></p>
<center>
<img alt="Doomsday Clock: Superman &amp; Manhattan" src="files/2022/doomsday-clock-superman.webp">
</center>
<br><p>This forms a genuine riposte to <em>Watchmen's</em> criticism of the superhero genre.
Yes, the DC heroes inhabit a simpler world, but the simplicity serves a purpose.
Escaping the mundane enhances the mythological power of what they represent as
symbols. Particularly the value of <em>hope</em>, as personified by Superman, which,
although possibly somewhat overwrought in the telling - quite literally, in
this tale - makes all other things possible.</p>
<p>I was especially pleased with the quiet, understated places Doomsday Clock goes
with <em>Mothman's</em>, back-story. The character in <em>Watchmen</em> was only a punchline,
a recurring throwaway reference to instability and alcoholism, telegraphing his
subsequent mental breakdown. But here, we see him fully fleshed out.</p>
<p>Like the rest of the <em>Watchmen</em> heroes, he has no magical superhuman powers,
but is still able to pull off entirely unexpected and superhuman-seeming
stunts, merely by the virtue of his own unique kind of extreme mental and
emotional resourcefulness. Flawed, but aware of his faults, and able to pull it
together when he needs to, he befriends the younger Rorschach II during their
overlapping stays in a mental institution, becoming a beacon of warmth,
kindness, and generosity to the younger man.</p>
<p>He acts as a symbol, if you will, that just as <em>Watchmen's</em> ruthless gaze
influenced the wider world of comics, so the comic world gazes back. They see
us, all the real-world, fully-rounded humans, trapped in the depths of our
pathos, and they wonder, when will each of us learn to transcend our humdrum
limitations, to finally act on our hopes and dreams, and <em>fly...</em></p>
<p></p>
<center>
<img alt="Doomsday Clock: Mothman" src="files/2022/doomsday-clock-mothman.webp">
</center>
<br>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/new-laptop-time/" class="u-url">New Laptop Time!</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/new-laptop-time/" rel="bookmark">
            <time class="published dt-published" datetime="2022-09-21T11:59:02-05:00" itemprop="datePublished" title="2022-09-21 11:59">2022-09-21 11:59</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><span style="float: left">
<img alt="A laptop" src="files/2008/02/lappy.webp"></span></p>
<p>My employer, Canonical, has a "bring your own hardware" policy, trusting that
their engineers would rather choose and administer their own personal laptops,
rather than put up with standardized remotely administered corporate hardware.</p>
<p>My current much loved Thinkpad 460p has served faithfully since 2015, but is
showing its age, sometimes struggling under the workload. Plus, its integrated
graphics chipset doesn't have the power to play modern games with my kiddo.
Battlezone 98 runs fine, but Civilization VI (2016) is annoyingly choppy,
at about 9 frames per second.</p>
<p></p>
<center>
<img alt="Civilization VI screenshot" src="files/2022/civ-vi.webp">
</center>
<br><p>This summer I received the three-year cash-in-hand bonus earmarked as a
"hardware refresh bonus". It's been many years since I've bought a laptop with
the attention to detail that comes with spending one's own money. Even the
current aging Thinkpad was a gift from a former employer. So it's been a decade
or more since I've seriously specced out a new laptop. This post exists as a
place to scribble down reminders of a few things I learned along the way.</p>
<p>I have a few constraints:</p>
<ul>
<li>About the same size as the current Thinkpad's 14 inches, or maybe a tiny bit
  bigger.</li>
<li>I work on Ubuntu Linux, so I'll need to check it plays nicely.</li>
<li>It should support modern gaming.</li>
<li>Plenty of monitor ports, and/or the grunt to daisy chain them.</li>
<li>Is it too much to ask for a headphone jack in 2022?</li>
<li>Ability for me to open it up, swap out the battery, drives, RAM.</li>
<li>3:2 display would be nice, but these are rare.</li>
<li>A budget of $2,000 (saving a bit of my bonus for other hardware-related things.)</li>
</ul>
<p>Reading around, I got sort-of up to speed on components.</p>
<h3>CPU</h3>
<p>The CPU buzz is around Intel's 12th generation (aka "Alder Lake"). These are
"hybrid" CPUs, combining large high performance cores with smaller high
efficiency cores on a single chip. They come in about 30 different variants,
with a naming convention that looks like, for example: <code>Intel Core i7-12700H</code>.
This consists of:</p>
<ul>
<li>A brand, eg. "Intel Core"</li>
<li>A modifier specifying a market segment, one of:<ul>
<li>i3 Casual use</li>
<li>i5 Multitasking, light gaming</li>
<li>i7 Gaming, content creators</li>
<li>i9 Slightly faster, more parallel cores.</li>
</ul>
</li>
<li>A single or double digit generation, eg the latest is "12".</li>
<li>An SKU, eg the "700" above, a three or four digit number which roughly
  corresponds to the feature-set or performance - larger is better. These are
  only comparable within a single generation, they adopt wildly different
  conventions in different generations.</li>
<li>A single or double letter suffix, eg "H" for "high performance", taken from
  <a href="https://www.intel.com/content/www/us/en/support/articles/000058567/processors/intel-core-processors.html">an idiotic irregular table</a>.</li>
</ul>
<p>The major alternative to an Intel processor is AMD. These aren't the current
season's darlings of the performance benchmarks, although they do include
several respectable contenders that might be great for my needs, as you can see
in the following performance comparison.</p>
<h4>Benchmarks</h4>
<p>These laptop CPU performance benchmarks are culled from
<a href="https://www.cpubenchmark.net/laptop.html">www.cpubenchmark.net</a>,
sorted by the benchmark score. I included the top 20, plus a handful of notable
others that I looked up along the way. The 'bench' column measures relative
performance under a variety of benchmark workloads which fully utilize all
cores. The higher this number, the better.</p>
<p>The number of cores is given as (p)erformance + (e)fficiency, for hybrid processors.</p>
<table>
<thead><tr>
<th>CPU</th>
<th style="text-align: left;">Cores</th>
<th style="text-align: right;">Clock</th>
<th style="text-align: right;">Cache</th>
<th style="text-align: right;">Bench</th>
<th>Price</th>
<th>Laptop models &amp; other notes</th>
</tr></thead>
<tbody>
<tr>
<td>i9-12900HX</td>
<td style="text-align: left;">8p+8e</td>
<td style="text-align: right;">5.0GHz</td>
<td style="text-align: right;">30MB</td>
<td style="text-align: right;">36</td>
<td>$606</td>
<td></td>
</tr>
<tr>
<td>i7-12800HX</td>
<td style="text-align: left;">8p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">25MB</td>
<td style="text-align: right;">35</td>
<td>$457</td>
<td>Thinkpad P16 ($2340).</td>
</tr>
<tr>
<td>i9-12950HX</td>
<td style="text-align: left;">8p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">30MB</td>
<td style="text-align: right;">34</td>
<td>$590</td>
<td></td>
</tr>
<tr>
<td>i7-12850HX</td>
<td style="text-align: left;">8p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">25MB</td>
<td style="text-align: right;">31</td>
<td>$428</td>
<td></td>
</tr>
<tr>
<td>i9-12900HK</td>
<td style="text-align: left;">6p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24MB</td>
<td style="text-align: right;">30</td>
<td>$635</td>
<td>Dell XPS 15 ($2950).</td>
</tr>
<tr>
<td>i9-12900H</td>
<td style="text-align: left;">6p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24MB</td>
<td style="text-align: right;">29</td>
<td>$617</td>
<td></td>
</tr>
<tr>
<td>i7-12700H</td>
<td style="text-align: left;">6p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24MB</td>
<td style="text-align: right;">27</td>
<td>$457</td>
<td>Dell XPS 17/15 ($2500), Acer Nitro 5, System76 Onyx &amp; Gazelle.<br><strong>This CPU is what I ended up getting.</strong>
</td>
</tr>
<tr>
<td>AMD Ryzen 9 6900HX</td>
<td style="text-align: left;">8</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">25</td>
<td></td>
<td>Fastest AMD processor.</td>
</tr>
<tr>
<td>i7-12650H</td>
<td style="text-align: left;">6p+4e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24MB</td>
<td style="text-align: right;">25</td>
<td>$457</td>
<td></td>
</tr>
<tr>
<td>i5-12600HX</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">25</td>
<td>$284</td>
<td>Fastest 12th gen i5. Suspiciously cheap.</td>
</tr>
<tr>
<td>AMD Ryzen 9 PRO 6950H</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24</td>
<td></td>
<td></td>
</tr>
<tr>
<td>i7-12800H</td>
<td style="text-align: left;">6p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24MB</td>
<td style="text-align: right;">24</td>
<td>$457</td>
<td></td>
</tr>
<tr>
<td>AMD Ryzen 7 PRO 6850H</td>
<td style="text-align: left;">8</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24</td>
<td></td>
<td>Thinkpad P15v.</td>
</tr>
<tr>
<td>AMD Ryzen 9 6900HS</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24</td>
<td></td>
<td>ASUS ROG Zephyr G14.</td>
</tr>
<tr>
<td>AMD Ryzen 9 PRO 6950HS</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">24</td>
<td></td>
<td></td>
</tr>
<tr>
<td>AMD Ryzen 7 PRO 6800H</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">23</td>
<td></td>
<td></td>
</tr>
<tr>
<td>i9-11980HK</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">2.6GHz</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">23</td>
<td>$583</td>
<td>Fastest Intel 11th gen.</td>
</tr>
<tr>
<td>AMD Ryzen 7 6800HS CEd</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">23</td>
<td></td>
<td></td>
</tr>
<tr>
<td>AMD Ryzen 9 5900HX</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">23</td>
<td></td>
<td></td>
</tr>
<tr>
<td>i9-11950H</td>
<td style="text-align: left;">8</td>
<td style="text-align: right;">2.6GHz</td>
<td style="text-align: right;">24MB</td>
<td style="text-align: right;">22</td>
<td>$556</td>
<td></td>
</tr>
<tr>
<td>...</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td>(I skipped a bunch here)</td>
</tr>
<tr>
<td>i7-1280P</td>
<td style="text-align: left;">6p+8e</td>
<td style="text-align: right;">4.8GHz</td>
<td style="text-align: right;">24MB</td>
<td style="text-align: right;">20</td>
<td>$482</td>
<td>Best Framework.</td>
</tr>
<tr>
<td>AMD Ryzen 7 5825U</td>
<td style="text-align: left;">8</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">18</td>
<td></td>
<td>Best Dell Inspiron 15".</td>
</tr>
<tr>
<td>i7-1260P</td>
<td style="text-align: left;">4p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">18MB</td>
<td style="text-align: right;">17</td>
<td>$438</td>
<td>XPS 13 plus, X1 Carbon gen 10, Thinkpad P14.</td>
</tr>
<tr>
<td>i7-1250U</td>
<td style="text-align: left;">2p+8e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">12MB</td>
<td style="text-align: right;">11</td>
<td>$426</td>
<td></td>
</tr>
<tr>
<td>i5-6200U</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">2.8GHz</td>
<td style="text-align: right;">3MB</td>
<td style="text-align: right;">3</td>
<td></td>
<td><strong>My current Thinkpad T460.</strong></td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Notice my current Thinkpad's processor at the very bottom of this list, which
is 10x slower than the CPU I ended up getting.</p>
<h3>Graphics</h3>
<p>There are plenty of otherwise fantastic laptops which don't include blazing
fast dedicated Nvidia or AMD graphics processors, but instead only come with
relatively humdrum graphics support integrated with the CPU. Although
integrated GPUs have improved massively in the last few years, this wouldn't be
fast enough to run modern games well.</p>
<p>To compensate, I considered pairing such laptops with an external GPU enclosure
(eGPU), into which a top-of-the-line desktop GPU card can be plugged. I'm still
wistfully curious about this path, but in the end opted to do without this
complication.</p>
<p>Here's a table of the top laptop GPUs, culled from
<a href="https://gpu.userbenchmark.com/">gpu.userbenchmark.com</a>. Unlike the CPU table,
this isn't the top N performers, because GPUs can get crazy fast and expensive,
so I'm looking for something middle-of-the-pack. It's just a selection of GPUs
I looked up while researching particular laptop models.</p>
<p>The 'performance' column is the combined result of a variety of gaming
benchmarks, the higher the better. The 'position' column compares the
performance against all other benchmarked GPUs.</p>
<table>
<thead><tr>
<th>GPU</th>
<th style="text-align: right;">Performance</th>
<th style="text-align: right;">Position</th>
<th>Laptop models &amp; other notes</th>
</tr></thead>
<tbody>
<tr>
<td>Nvidia GeForce RTX 3080</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">24th</td>
<td>System76 Onyx option.</td>
</tr>
<tr>
<td>Nvidia GeForce RTX 3070Ti</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">27th</td>
<td>System76 Onyx option.</td>
</tr>
<tr>
<td>Nvidia GeForce RTX 3070</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">30th</td>
<td></td>
</tr>
<tr>
<td>Nvidia GeForce RTX 3060</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">58th</td>
<td>Best XPS 17. System76 Gazelle. Acer Nitro 5.<br><strong>This is the GPU I ended up getting.</strong>
</td>
</tr>
<tr>
<td>Nvidia GeForce RTX 3050Ti</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>XPS 15 option.</td>
</tr>
<tr>
<td>Nvidia GeForce RTX 3050</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>XPS 15 option.</td>
</tr>
<tr>
<td>AMD Radeon RX 6800S</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">58th</td>
<td></td>
</tr>
<tr>
<td>AMD    RX 6700M</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">65th</td>
<td></td>
</tr>
<tr>
<td>Nvidia RTX A1000 4GB GDDR6</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">114th</td>
<td>Thinkpad P16(certified)</td>
</tr>
<tr>
<td>Nvidia T1200</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">118th</td>
<td>Thinkpad P15v</td>
</tr>
<tr>
<td>Nvidia GTX 1050Ti</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">144th</td>
<td>My current Windows gaming desktop.</td>
</tr>
<tr>
<td>Intel Iris Xe</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">207th</td>
<td>Integrated. Framework. XPS 13 Plus.</td>
</tr>
<tr>
<td>Intel HD 520</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">402nd</td>
<td>Integrated. <strong>My current Thinkpad T460.</strong>
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Notice the two 'integrated' entries at the bottom of the table, one of which is
my current laptop, a full 20x slower than the GPU I ended up getting. The
improvement ought to speed Civilization VI up to around an entirely excessive
180 frames per second. \o/</p>
<h3>Laptop models</h3>
<p>With the above in mind, I read some reviews, and a few contenders emerged:</p>
<h4>Framework</h4>
<p>The Framework was massively tempting. It brings an entirely unprecedented
- some might hopefully say <em>revolutionary</em> - focus on user-repair and
upgradability. Rather than soldering and gluing the whole thing together,
all the Framework's components, up to and including the motherboard and
screen, are replaceable using a single screwdriver. This is deeply appealing
for geeks, who want to be able to repair or upgrade.</p>
<p>The downside that gave me pause is it is only available with integrated
Intel-powered graphics. If they had a model including the vastly superior
Nvidia or AMD accelerated graphics, I would have just bought one months ago,
instead of prevaricating. But that complication, coupled with the fact that the
Framework's performance is only mid-range for a 2022 model, put me off
sufficiently to look around at other options.</p>
<h4>Dell XPS 13 plus</h4>
<p>The Dell XPS 13 plus looks wonderful, with official Ubuntu verification, no
less, but just isn't physically big enough for me, and is noticeably
underpowered. And the Dell 15 inch models seem way overpriced, for the spec,
easily exceeding my $2,000 budget.</p>
<h4>HP Dev One</h4>
<p>The HP Dev One looks like a fabulous machine, a colleague just got one and is
very happy with it. But again, it only has integrated graphics.</p>
<h4>Mac Book Pro</h4>
<p>I considered this, repaved to run Ubuntu, of course, but to be honest, as
exquisite as the hardware was at one point, it seems somewhat stagnant and
directionless now, fifteen years later. Not unimpressive, but doesn't really
grab me.</p>
<h4>System76</h4>
<p>I looked at a whole bunch of other laptops at this point, scouring the "best
gaming laptops of 2022" lists at Toms Hardware and elsewhere. Eventually my
attention was drawn to System76, who, on reflection, should have been folks I
checked out earlier in the process.</p>
<p>The Oryx is just a few hundred over my budget, even with the current $300 off.
But a tricked-out Gazelle seems to check all the boxes.</p>
<p></p>
<center>
<img alt='Gazelle 15" laptop' src="files/2022/gazelle-15.avif">
</center>
<p>They have a reasonably high-ranked 12th generation Intel i7 CPU, which seems
to achieve good performance without wading into the diminishing returns
of pricey i9 models. Same for the reasonably-placed Nvidia 3060 graphics. And
the screen is just magic (judged by my admittedly idiosyncratic personal
criteria.)</p>
<p>They support the lightning fast open source <a href="https://www.coreboot.org">coreboot
firmware</a>, and System76 are a leading contributor to
the project. They sell with Linux-pre-installed, and produce their own
Ubuntu-based Linux distribution, Pop!_OS (Although stock Ubuntu runs just fine
too.).</p>
<p>Going with Nvidia graphics instead of AMD does yield a performance boost, but
the downside is that I'll have to wrestle with the opaque proprietary drivers
from the famously uncooperative Nvidia. But in a nice gesture, System76
<a href="https://support.system76.com/articles/graphics-switch-ubuntu">documents this
process</a>, and
lots of other stuff, such as how to replace internal components yourself, on
their website.</p>
<p>Because it's proprietary closed source, Nvidia drivers have always lagged
behind AMD's open source offerings in terms of compatibility. In particular,
Nvidia graphics hasn't worked with the new Linux Wayland display server.
Reading around, my impression is that it's not ready yet, but <em>might</em> be by
22.10 (which is next month!?), so I could stick with the older XOrg display
server for now, without fearing that I'll get marooned there.</p>
<p>There are other downsides. The keyboard is reputedly mediocre, and I wish it
didn't have a numpad. Standard layout tenkeyless for the win, every time. But I
almost always use a USB mechanical keyboard anyhow. Also, with such greedy
components, the battery life kinda sucks when the GPU is on and the machine is
busy. But in the last 12 months, the only time I've run my current laptop not
plugged in is... never? So I guess I don't care.</p>
<p>So <a href="https://system76.com/laptops/gazelle#specs">this</a> is what I ordered, with
the 15" display and the 3060 graphics.</p>
<p>But I did that thing where I order it with minimal RAM and SSD storage, to
replace with my own parts. So I'll have some screwdriver work to do after it
arrives. The payoff is that I save about $150 by paying market rates for these
components. In fact I already have a <a href="https://www.amazon.com/WD_Black-SN850-Internal-Gaming-Solid/dp/B0B7CPSN2K">tremendous
SSD</a>
I can use, leftover from this year's Chia cryptocurrency farming experiments,
so that part is free. This means I can stay within my $2,000 budget, with $9 to
spare after shipping and taxes.</p>
<h3>Memory</h3>
<p>It's generally fine to just buy whatever RAM is recommended by your vendor.
But the most reliable and cheapest memory will often be the slowest, or at least
the one running at a clock speed which is most widely supported by different
motherboards. In order to get the <em>fastest</em> memory for our particular laptop, we
need to understand a few things.</p>
<h4>Physical form factor</h4>
<p>The current standard for RAM is DDR4. For laptops, the slim physical form
factor is known as SoDIMM. A single circuit board of memory chips is a
<em>module</em>. A module connects into a motherboard <em>slot</em>.</p>
<p>DDR5 is supported by Intel's 12th generation processors, and AMD's newest Ryzen
7000 series. This uses a different physical connection on the motherboard, and
is rare thus far, outside of systems above my budget.</p>
<p>So I'm looking for DDR4 in a SoDIMM module. Got it.</p>
<h4>Ranks &amp; Channels</h4>
<p>A module contains from one to eight 64-bit wide logical <em>blocks</em> of data storage
(single, dual, quad or octal <em>rank</em>.) The chips on a module provide x1, x2, x4
or x8 <em>banks</em>.</p>
<div class="code"><pre class="code literal-block">number of chips x chip banks / 64 = module rank
</pre></div>

<p>eg. Using sixteen x4 chips will provide a single rank of memory on the module
(16x4/64=1).</p>
<p>Whereas using 32 x8 chips will provide a module of 4 ranks (32x8/64=4).</p>
<p>This is sometimes annotated on the module using a notation like 1Rx4, as in one
rank of x4 chips.</p>
<p>The reason this matters is that access to ranks is interleaved, so multiple
ranks can provide access to data at multiples of the rate provided by a single
rank. In order to take advantage of this, the motherboard must provide a
commensurate number of memory access <em>channels</em>.</p>
<p>The
<a href="https://tech-docs.system76.com/models/gaze17/README.html">datasheet for my Gazelle</a>
says the motherboard has two memory slots, and supports dual-channel access.
This could be fully utilized by either inserting a single dual-rank module
(which is more expensive), or, as in the timeworn heuristic, by inserting two
half-sized single rank modules (e.g. two 16GB modules to make 32GB total.)</p>
<h4>Clock frequencies and latency</h4>
<p>RAM has a clock frequency, measured in thousands of MHz, but "double data rate"
chips transfer data on both the clock's rising and falling edges, so the speed
of transfer is better measured in mega-transfers per second (MT/s), the higher
the better.</p>
<p>However, it takes more than one clock cycle to perform an action. These latency
values are sometimes quoted as a series of four integers - the number of clock
cycles to perform particular operations, e.g. 18-18-18-43. But these are often
abbreviated to just the first number, representing read access time, known as
"CAS Latency" (CL), eg. CL 18, which tends to be representative. The lower this
number is, the better.</p>
<p>The actual performance of the memory is determined by the product of a clock
cycle duration (eg. 1ns at 1000MHz) and the latency number (e.g. 1ns * 18 =
18ns)</p>
<p>Further, the motherboard needs to support the RAM's clock speed. In practice,
the motherboard will negotiate with the inserted modules to find a commonly
supported frequency, the same or less than the minimum of the rated memory
access frequencies of the module, the motherboard, and the CPU, using an
over-complicated and hard-to-predict process controlled by BIOS settings. I
have no experience with this but it sounds well worth avoiding altogether by
making sure we get modules with a rated frequency that exactly matches the
advertised clock frequency of our motherboard.</p>
<p>For my new Gazelle,
<a href="https://tech-docs.system76.com/models/gaze17/README.html">the manual</a>
says that is 3,200MHz.</p>
<h4>Availability, pricing and scams.</h4>
<p>Finding CL26 latency RAM at 3,200MHz is easy, for around $70. For lower
latencies the price goes up to about $375 for CL16, but that isn't even in
stock anywhere.</p>
<p>At one point, after much searching, I found some CL16 on newegg.com:</p>
<p><img alt="Memory on sale in Newegg - scam" src="files/2022/memory-on-sale.webp"></p>
<p>And it is only $128! Carefully checking the specs, including those on the
manufacturer's site, using the shown model number 'CMSX32GX4M2A3000C16',
this is exactly what we want. 2x16GB at 3200MT/s at CL16.</p>
<p>While checking it out, I clicked around a bit, and at one point found:</p>
<p><img alt="Bad review on Newegg" src="files/2022/bad-review-on-newegg.webp"></p>
<p>This came along with a number of other negative reviews, stating customers had
been sent memory modules that were fake, ie. imitations of the purported
reputable manufacturer, they didn't work at the advertised clock speeds, and
the seller had gone dark on them, taking weeks to respond to queries, and not
sending replacements until Newegg got involved. Seems wisest to skip this.</p>
<p>Eventually I found an alternative:</p>
<p><img alt="Memory on sale in Newegg - legit" src="files/2022/memory-on-sale-legit.webp"></p>
<p>Yes! DDR4 in a SoDIMM package, 2x16GB modules at 3,200MHz and 18CL. The latency
isn't quite as good, but it sounds legit, so I'll take it!</p>
<p>And with that, I'm done. Now just awaiting the deliveries to arrive...</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/neuromancer/" class="u-url">Neuromancer</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/neuromancer/" rel="bookmark">
            <time class="published dt-published" datetime="2022-09-19T11:22:12-05:00" itemprop="datePublished" title="2022-09-19 11:22">2022-09-19 11:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><span style="float: left; padding: 1em;">
<img alt="Neuromancer cover" src="files/2022/neuromancer-cover.webp"></span></p>
<p><em>by William Gibson, 1984.</em></p>
<blockquote>
<p><em>The sky above the port was the color of television, tuned to a dead channel.</em></p>
</blockquote>
<p>So opens William Gibson's debut novel, and it is to his eternal credit that we
all still remember the line now, nearly forty years later. I don't usually do
audiobooks, but I made an exception for this.</p>
<blockquote>
<p><em>The bartender’s smile widened. His ugliness was the stuff of legend. In an
age of affordable beauty, there was something heraldic about his lack of it.</em></p>
</blockquote>
<p>Unlike the majority of the beloved science fiction of my youth, Gibson's
poetic, literary style has only increased in my estimation over the subsequent
decades.</p>
<blockquote>
<p><em>Cyberspace. A consensual hallucination experienced daily by billions of
legitimate operators, in every nation. By children, being taught mathematical
concepts. A graphic representation of data abstracted from the banks of every
computer in the human system. Unthinkable complexity. Lines of light ranged
in the nonspace of the mind, clusters and constellations of data. Like city
lights, receding.</em></p>
</blockquote>
<p>The consensual hallucination might seem prosaic now, but one has to remember
this was written back when the internet connected less than 1,000 hosts,
accessed via green screen text terminals on university campuses.</p>
<blockquote>
<p><em>He'd made the classic mistake, the one he'd sworn he'd never make. He stole
from his employers. [...] Of course he was welcome, they told him, welcome
to the money. And he was going to need it. Because — still smiling
— they were going to make sure he never worked again. They damaged his
nervous system with a wartime Russian mycotoxin. Strapped to a bed in a
Memphis hotel, his talent burning out micron by micron, he hallucinated for
thirty hours. The damage was minute, subtle, and utterly effective. For Case,
who lived for the bodiless exultation of cyberspace, it was the Fall. In the
bars he'd frequented as a cowboy hotshot, the elite stance involved a certain
relaxed contempt for the flesh. The body was meat. Case fell into the prison
of his own flesh.</em></p>
</blockquote>
<p>He introduced the world to cyberpunk, combining the fatalistic noire of Blade
Runner with the relentless dehumanizing advances of a libertarian tech
dystopia, to create a startlingly original warning of our possible future that
looks, as the decades tumble by, increasingly on-the-nose.</p>
<blockquote>
<p><em>A year here and he still dreamed of cyberspace, hope fading nightly. All the
speed he took, all the turns he'd taken and the corners he cut in Night City,
and he'd still see the matrix in his dreams, bright lattices of logic
unfolding across that colourless void... The Sprawl was a long, strange way
home now over the Pacific, and he was no console man, no cyberspace cowboy.
Just another hustler, trying to make it through. But the dreams came on in
the Japanese night like livewire voodoo, and he'd cry for it, cry in his
sleep, and wake alone in the dark, curled in his capsule in some coffin
hotel, hands clawed into the bedslab, temper foam bunched between his
fingers, trying to reach the console that wasn't there.</em></p>
</blockquote>
<p>There are several versions of Neuromancer as an audiobook. The slightly
abridged six-hour version <a href="https://archive.org/details/NeuromancerReadByWilliamGibson">available for free at the Internet
Archive</a> is notable
for two things: it is read by William Gibson himself, and it is an extremely
low quality rip from an audiocassette.</p>
<blockquote>
<p><em>Night City wasn’t there for its inhabitants, but as a deliberately
unsupervised playground for technology itself. Like a deranged experiment in
social Darwinism, designed by a bored researcher who kept one thumb
permanently on the fast-forward button. Biz here was a constant subliminal
hum, and death the accepted punishment for laziness, carelessness, lack of
grace, failure to heed the demands of an intricate protocol.</em></p>
</blockquote>
<p>The audio quality might make anyone immediately pass this version by. It isn't
just noisy, but features discernible wow and flutter - artifacts characteristic
of the stretching or uneven speed of its original tape based media.</p>
<blockquote>
<p><em>He closed his eyes. Found the ridged face of the power stud. And in the
bloodlit dark behind his eyes, silver phosphenes boiled in from the edge of
space, hypnagogic images jerking past like a film compiled of random frames.
Symbols, figures, faces, a blurred, fragmented mandala of visual information.
Please, he prayed, now- A gray disk, the color of Chiba sky. Now- Disk
beginning to rotate, faster, becoming a sphere of paler gray. Expanding- And
flowed, flowered for him, fluid neon origami trick, the unfolding of
distanceless home, his country, transparent 3D chessboard extending to
infinity. Inner eye opening to the stepped scarlet pyramid of the Eastern
Seaboard Fission Authority burning beyond the green cubes of Mitsubishi Bank
of America, and high and very far away he saw the spiral arms of the military
systems, forever beyond his reach. And somewhere he was laughing, in a
white-painted loft, distant fingers caressing the deck, tears of release
streaking his face.</em></p>
</blockquote>
<p>But I'd urge you to stick with it. For the author's reedy, Virginia-inflected
voice has a cadence that holds the attention. A rhythm of tone and emphasis
that, for me, works considerably better than the practiced glossiness of more
recent, more professional recordings.</p>
<blockquote>
<p><em>"The moment, I mean the nanosecond, that one of those things starts figuring
out ways to make itself smarter, Turing’ll wipe it. Nobody trusts those
fuckers, you know that. Every AI ever built has an electromagnetic shotgun
wired to its forehead."</em></p>
</blockquote>
<p>By the end of the second chapter, I'd stopped being bothered by the audio
quality, and by chapter three, it had become an intrinsic part of the
experience.</p>
<blockquote>
<p><em>It was disturbing to think of the Flatline as a construct, a hardwired ROM
cassette replicating a dead man's skills, obsessions, kneejerk responses.<br>
[...]<br>
He slotted some ice, connected the construct, and jacked in.
It was exactly the sensation of someone reading over his shoulder.
He coughed.<br>
  "Dix? McCoy? That you man?' His throat was tight.<br>
"Hey, bro," said a directionless voice.<br>
"It's Case, man. Remember?"<br>
"Miami, joeboy, quick study."<br>
"What's the last thing you remember before I spoke to you, Dix?"<br>
"Nothin'."<br>
"Hang on." He disconnected the construct. The presence was gone. He reconnected it. "Dix? Who am I?"<br>
"You got me hung, Jack. Who the fuck are you?"<br>
"Remember being here, a second ago?"<br>
"No."<br>
"Know how a ROM personality matrix works?"<br>
"Sure, bro, it's a firmware construct."<br>
"So I jack it into the bank I'm using, I can give it sequential, real time memory?"<br>
"Guess so," said the construct.<br>
"Okay, Dix. You <b>are</b> a ROM construct. Got me?"<br>
"If you say so," said the construct. "Who are you?"<br>
"Case."<br>
"Miami," said the voice, "joeboy, quick study."<br>
"Right. And for starts, Dix, you and me, we're gonna sleaze over to London grid and access a little data. You game for that?"<br>
"You gonna tell me I got a choice, boy?"<br></em></p>
</blockquote>
<p>A distortion so thoroughly appropriate to the underlying material
it was as though Gibson had planned it this way all along, speaking directly to
me via a weak signal, projected through time by the noisy filters of this
obsolete electro-mechanical recording mechanism. The words at once clear and
irrevocably decayed, fuzzy sounding but still stark and unmistakable in their
meaning.</p>
<blockquote>
<p><em>"Dixie?"<br>
"Yeah."<br>
"You ever try to crack an AI?"<br>
"Sure. I flatlined. First time. I was larkin', jacked up real high, out by Rio heavy commerce sector. Big biz, multinationals, Government of Brazil lit up like a Christmas tree. Just larkin' around, you know? And then I started picking up on this one cube, maybe three levels higher up. Jacked up there and made a pass."<br>
"What did it look like, the visual?"<br>
"White cube."<br>
"How'd you know it was an AI?"<br>
"How'd I know? Jesus. It was the densest ice I'd ever seen. So what else was it? The military down there don't have any thing like that. Anyway, I jacked out and told my computer to look it up."<br>
"Yeah?"<br>
"It was on the Turing Registry. AI. Frog company owned its Rio mainframe."<br>
Case chewed his lower lip and gazed out across the plateaus of the Eastern Seaboard Fission Authority, into the infinite neuroelectronic void of the matrix. "Tessier-Ashpool, Dixie?"<br>
"Tessier, yeah."<br>
"And you went back?"<br>
"Sure. I was crazy. Figured I'd try to cut it. Hit the first strata and that's all she wrote. My joeboy smelled the skin frying and pulled the trodes off me. Mean shit, that ice."<br>
"And your EEG was flat."<br>
"Well, that's the stuff of legend, ain't it?'</em></p>
</blockquote>
<p>Five out of five stars. A riveting performance.</p>
<p><br style="clear: left"></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-27.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer"></footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
