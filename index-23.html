<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A website devoted to oneself has been described, by my Father, no less, as the greatest act of hubris. Welcome aboard!">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Made out of meat (old posts, page 23) | Made out of meat</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://www.tartley.com/index-23.html">
<link rel="icon" href="welcome.gif" sizes="16x16">
<link rel="prev" href="index-24.html" type="text/html">
<link rel="next" href="index-22.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://www.tartley.com/">

                <span id="blog-title">Made out of meat</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Posts</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="galleries/Drawings">Gallery</a>
                </li>
<li>
<a href="rss.xml">RSS</a>
                </li>
<li>
<a href="pages/about/">About</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://www.tartley.com/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    <a rel="me" href="https://mastodon.social/@tartley"></a>
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/git-annotated-tags/" class="u-url">TIL: Git Annotated Tags</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/git-annotated-tags/" rel="bookmark">
            <time class="published dt-published" datetime="2020-10-17T00:40:24-05:00" itemprop="datePublished" title="2020-10-17 00:40">2020-10-17 00:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've previously only ever used git's regular <em>lightweight</em> tags, created with
<code>git tag TAGNAME</code>.</p>
<p>Today I learned about <em>annotated</em> tags, created with <code>git tag -a -m "MESSAGE"
TAGNAME</code>. If you don't specify <code>-m MESSAGE</code>, git annoyingly prompts you for
one, but it will accept <code>-m ""</code>.</p>
<p>Annotated tags store the creator, created timestamp, and the message. This
might occasionally be useful for understanding what happened. A release tagged
this way shows us who created the release, and when, which might differ from
when the commit was created.</p>
<p>But more importantly is the different handling of lightweight versus
annotated tags when pushing to the server.</p>
<p>Habitually, I've been using <code>git push --tags</code>. But this is slightly broken, in
that it pushes <em>all</em> tags. Some tags might be intended as my private local
development state. Some of them might be unreachable in the origin repo.</p>
<p>To address these issues, newer versions of <code>git push</code> introduced
<code>--follow-tags</code>, which only pushes annotated tags which are on ancestors
of the commit being pushed, so that no unreachable tags are created on origin.</p>
<p>Hence, a better workflow is:</p>
<ol>
<li>Use regular lightweight tags for local state.
   Keep them private by never using <code>git push --tags</code>.</li>
<li>Use annotated tags to share state with other developers.</li>
<li>To share annotated tags, either push them directly, with <code>git push TAGNAME</code>,
   or use <code>git push --follow-tags</code>.</li>
</ol>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/per-mille/" class="u-url">TIL: ‰ is per mille</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/per-mille/" rel="bookmark">
            <time class="published dt-published" datetime="2020-10-17T00:25:45-05:00" itemprop="datePublished" title="2020-10-17 00:25">2020-10-17 00:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>‰ or <em>'per mille'</em> means parts per thousand.</p>
<p>I wasn't aware of it until today when I idly Googled "permil", my imagined
variation on "percent", to find that this is one of the many spellings of
a real thing. Rarely used in English, but more common in other European
languages.</p>
<p>Now that I see the symbol, I remember seeing it as a child, on an old
typewriter that my Grandfather used. What's old is new.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-structure-of-scientific-revolutions/" class="u-url">The Structure of Scientific Revolutions</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/the-structure-of-scientific-revolutions/" rel="bookmark">
            <time class="published dt-published" datetime="2020-06-14T09:02:22-05:00" itemprop="datePublished" title="2020-06-14 09:02">2020-06-14 09:02</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>This post rescues content from a series of tweets I wrote in 2018.</p>
<hr>
<p><span style="float: left">
<img alt="The Structure of Scientific Revolutions cover" src="files/2020/the-structure-of-scientific-revolutions-cover.jpg"></span></p>
<p><em>by Thomas S. Kuhn, 1962.</em> <img alt="spoilers" src="files/spoilers.svg"></p>
<p>I loved <em>The Structure of Scientfic Revolutions</em>.
It was recommended to me as having similar impact to undergraduate
classics like <em>Godel, Escher, Bach</em>, or <em>The Blind Watchmaker.</em> I'm going
to just summarize the content here, so: Spoilers.</p>
<p>It begins by observing that discredited scientific theories, even those
which seem laughable today, such as phrenology, or the Ptolemaic model of the
heavens, were not crackpot theories with shaky evidence. Earnest, hardworking
practitioners refined them using sensible processes, which by the 17th century
were converging on the modern scientific method.</p>
<p>This process of "normal" science excels at the incremental refinement of
established scientific theories. But in practice, is unable to perform the
revolutionary transitions required to overcome outmoded theories and replace
them with others, no matter how bizarre and wrongheaded the initial theory
looks to us now with hindsight.</p>
<p>So what is the unarticulated process that is responsible for these
transitions, i.e. how do scientific revolutions happen? We have intuitive
visions of this occurring overnight. An individual experiment yields unexpected
results, contradicting conventional theory, while irrefutably supporting an
alternate theory to take its place. But in practice, this <em>never</em> happens.</p>
<p>At first, and often for years or centuries, no discrepancy between theory and
experiment is noticed, because the prevailing theories of the time have a
massive shaping effect on what questions it is valid to ask, what experiments
are deemed useful to do.</p>
<p>For practitioners to turn their backs on an established theory in such a time
is never productive. They are shunned for turning their backs on science
itself.</p>
<p>We see this vividly today with homeopaths (my own example, not the book's).
Often, and incorrectly, homeopathy is mocked because the theories sound
ridiculous to one steeped in a conventional understanding of chemistry.
People will jeer at how total dilution can 'obviously' have no effect,
or at the idea of water exhibiting some sort of 'memory'. But such jeering is
as scientifically illiterate as the quacks it contends with. The argument from
personal incredulity has no place in determining scientific truth. No newer
theory makes sense in the light of the more limited, and often contradictory,
paradigm that it eventually replaces. The only useful criteria is to try it
out. <em>Does it actually work?</em> This is the axis upon which homeopathy should be
judged. (and upon which it has decisively been found wanting.)</p>
<p>All contradictions to conventional science suffer a similar ignominious
treatment, regardless of how right they might later turn out to be. Before any
revolution of theory can overturn conventional understanding, the stage
must be set, the community prepared.</p>
<p>The process begins as the incremental advances of "normal" science gradually
increase the scope and precision of accepted theories. Until this point,
measurements in which experiment does not conform to theory are either ignored
as erroneous artifacts, or are dismissed as indicative of some separate,
unknown phenomena. They are never interpreted to mean prevailing theory is
wrong.</p>
<p>However the growing scope &amp; precision of theory and measurement gradually
uncovers more of these discrepancies, or reveals them in finer detail.
Eventually they become too prominent to ignore, and a kind of phase transition
occurs.</p>
<p>Eventually, the discrepancies become so prominent and concerning that they
are judged to be a valid area of study in themselves, rather than just annoying
aberrations. Leading practitioners devote themselves to the task. Foundations
of the specialisation that were once accepted without question now come under
scrutiny.</p>
<p>To partially explain the discrepancies, people introduce many incompatible
variations on current theories. The once unified field divides into cliques,
supporting different theoretical variations. The field, formerly a united mass,
calves into fragments.</p>
<p>If one of these variations on existing theory manages to explain all
observations, then this gradually gains mindshare, until the whole community
has migrated to this new, incrementally improved theory.</p>
<p>However, in cases where a truly revolutionary change is required, such
incrementalism is insufficient, and none of the theoretical variations are
fully successful in explaining all observations. The factions' differing
underlying assumptions give them no common ground upon which to arbitrate their
differences, so their debates are irreconcilable. The fragments are melting,
into a churning liquid of disagreement.</p>
<p>This state is notably similar to the state of a nascent field before any
established scientific theories have taken hold.</p>
<p>All is chaos, with different groups supporting different ideas, agreeing on
nothing. The field is in turmoil, its practitioners in genuine emotional
distress. Their personal identities are undermined. What does it mean to be a
practitioner when nobody can agree on what the field even is? Is what we do
even <em>science</em> at all? A crisis has arrived. We are at boiling point.</p>
<p>Kuhn compares this to individuals in psychological experiments, given cunningly
contradictory sensual stimuli. At first they don't notice anything wrong about
a brief glimpse of a playing card showing a red king of clubs. As the length of
their glimpse expands, and the stimulation becomes more intrusive, the subject
starts to hesitate, and stumble on words. Suddenly it impinges on their
consciousness, and they cry out, distressed, uncertain of even basic facts. "My
God! What did I see? Are clubs always red? What's happening here?"</p>
<p>Kuhn also compares scientific revolutions to their social and political
counterparts, in a chillingly familiar passage:</p>
<blockquote>
<p>"Political revolutions aim to change political institutions in ways that
those institutions themselves prohibit. Their success therefore necessitates
the partial relinquishment of one set of institutions in favor of another, and
in the interim society is not fully governed by institutions at all.</p>
<p>Initially it is crisis alone that attenuates the role of political
institutions [...] In increasing numbers, individuals become increasingly
estranged from political life, and behave more &amp; more eccentrically within
it.</p>
<p>Then, as the crisis deepens, many individuals commit themselves to [...] some
new institutional framework. At that point, society is divided into competing
camps or parties, one seeking to defend the old institutional constellation,
others seeking to institute some new one.</p>
<p>Once that polarization has occurred, <em>political recourse fails</em>. Because
they differ about the political matrix within which political change is to be
achieved and evaluated, and acknowledge no common supra-institutional framework
for adjudication of differences, the parties to a revolutionary conflict must
finally resort to the techniques of mass persuasion, often including force."</p>
</blockquote>
<p>At any point, the <em>boldest</em> practitioners, often those with least invested in
the previous status quo, such as the relatively young, or those entering from
adjacent fields, will introduce strikingly different sets of theories. But only
now that the stage is set, amongst such distressing chaos, is the community
ready to entertain truly revolutionary ideas.</p>
<p>Occasionally, one of these new ideas will succeed in explaining all the
observations, but in order to do so, it requires incommensurable changes in the
underlying philosophy of the field, from the axiomatic definitions, to the set
of questions that are valid to ask. One can no longer ask, of a spherical
Earth, "What happens if you fall off?"</p>
<p>Notably, many revolutionary changes are not an unalloyed good. Gains in
explicative power in one area are often balanced by losses elsewhere.</p>
<p>As in evolution, the new theory is not necessarily more <em>correct</em>, so much as
it is a better fit for the current circumstances, i.e. providing greater
predictive power in an area that is currently pertinent. Maybe scientific
progress is more obviously useful to society in that area, or instruments are
more capable of making measurements in that area. The two often coincide,
since influences are are unable to detect or manipulate are also unlikely to
be of much direct use to society. So as the social and technological context
evolves, so does the relative fitness of potential competing paradigms.</p>
<p>Nobody understands this trade-off more deeply than the field's most
invested practitioners, who feel the losses of losing the old model most
keenly, and therefore may resist the new paradigm for the remainder of their
careers. The new paradigm will not achieve total dominance until the field is
populated by a whole new generation.</p>
<p>I am reminded of the dark priesthood of command-line programmers, although
I note with no little joy that our merry band includes some of the best and
brightest of the next generation (as judged by my own paradigm's criteria.)</p>
<p><br style="clear: left"></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/format-python-snippets-with-black/" class="u-url">TIL: Format Python Snippets with Black.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/format-python-snippets-with-black/" rel="bookmark">
            <time class="published dt-published" datetime="2020-06-09T19:36:58Z" itemprop="datePublished" title="2020-06-09 19:36">2020-06-09 19:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Black, the opinionated Python code formatter, can easily be invoked from your
editor to reformat a whole file. For example, from Vim:</p>
<div class="code"><pre class="code literal-block"><span class="c">" Black(Python) format the whole file</span>
<span class="nb">nnoremap</span> <span class="p">&lt;</span>leader<span class="p">&gt;</span><span class="k">b</span> :<span class="m">1</span><span class="p">,</span>$<span class="p">!</span>black <span class="p">-</span><span class="k">q</span> <span class="p">-&lt;</span>CR<span class="p">&gt;</span>
</pre></div>

<p>But often you'd like to reformat just a section of the file, while leaving
everything else intact. In principle, it's easy to tell Vim to just send the
current visual selection:</p>
<div class="code"><pre class="code literal-block"><span class="c">" Black(Python) format the visual selection</span>
xnoremap <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">b</span> :<span class="p">!</span>black <span class="p">-</span><span class="k">q</span> <span class="p">-&lt;</span>CR<span class="p">&gt;</span>
</pre></div>

<p>(Note that both the above Vim configuration snippets map the same key
sequence -- leader (commonly comma) followed by lower case b. These can be
defined simultaneously, because the second one uses 'xnoremap', meaning it is
used only while a visual selection exists, while the first uses 'nnoremap', so
is used all other times.)</p>
<p>But if the given code starts with an indent on the first line, for example if
it comes from lines in the middle of a function, then this won't work. Black
parses the given code into a Python abstract syntax tree (AST), and a leading
indent is a syntax error - it's just not valid Python.</p>
<p>I filed a hopeful <a href="https://github.com/psf/black/issues/1352">issue with Black</a>,
suggesting they could handle this case, but it was a long shot and hasn't
gained much enthusiasm.</p>
<p>So, I present a tiny Python3 wrapper, <em>enblacken</em>, which:</p>
<ul>
<li>Unindents the given code such that the first line has no indent.</li>
<li>Passes the result to Black.</li>
<li>Reindents Black's output, by the same amount as the original unindent.</li>
</ul>
<p>See <a href="https://github.com/tartley/dotfiles/blob/main/bin/enblacken">enblacken on github</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/lxd-for-dev-env/" class="u-url">LXD for Development Environments.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/lxd-for-dev-env/" rel="bookmark">
            <time class="published dt-published" datetime="2020-04-20T13:57:47-05:00" itemprop="datePublished" title="2020-04-20 13:57">2020-04-20 13:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><a href="https://twitter.com/hjwp/status/1249636076660174849">@hjwp asks</a>:</p>
<blockquote>
<p>I would be interested in seeing some example lxd config files,
bash command history when creating, etc?</p>
</blockquote>
<p>Here goes then.</p>
<p>I have one LXD container running for each nontrivial development project I'm
working on.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>lxc<span class="w"> </span>ls
<span class="p">|</span><span class="w">    </span>NAME<span class="w">     </span><span class="p">|</span><span class="w">  </span>STATE<span class="w">  </span><span class="p">|</span><span class="w">        </span>IPV4<span class="w">         </span><span class="p">|</span><span class="w"> </span>IPV6<span class="w"> </span><span class="p">|</span><span class="w">   </span>TYPE<span class="w">    </span><span class="p">|</span><span class="w"> </span>SNAPSHOTS<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>devicegw<span class="w">    </span><span class="p">|</span><span class="w"> </span>RUNNING<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span>.44.99.228<span class="w"> </span><span class="o">(</span>eth0<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="p">|</span><span class="w"> </span>CONTAINER<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>ident<span class="w">       </span><span class="p">|</span><span class="w"> </span>RUNNING<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span>.44.99.4<span class="w"> </span><span class="o">(</span>eth0<span class="o">)</span><span class="w">   </span><span class="p">|</span><span class="w">      </span><span class="p">|</span><span class="w"> </span>CONTAINER<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>revs<span class="w">        </span><span class="p">|</span><span class="w"> </span>RUNNING<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span>.44.99.151<span class="w"> </span><span class="o">(</span>eth0<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="p">|</span><span class="w"> </span>CONTAINER<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>siab<span class="w">        </span><span class="p">|</span><span class="w"> </span>RUNNING<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span>.44.99.128<span class="w"> </span><span class="o">(</span>eth0<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="p">|</span><span class="w"> </span>CONTAINER<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>tartley-com<span class="w"> </span><span class="p">|</span><span class="w"> </span>RUNNING<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span>.44.99.161<span class="w"> </span><span class="o">(</span>eth0<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="p">|</span><span class="w"> </span>CONTAINER<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">         </span><span class="p">|</span>
</pre></div>

<p>Out of the gate we see one source of confusion. "LXD", the daemon, is a
newer project that builds on top of "LXC" the containers. However the user
interface to all the new LXD-goodness is through a command-line called "lxc",
which replaces the older command line tool called "lxd". :-/</p>
<p>To create a new one:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">time</span><span class="w"> </span>lxc<span class="w"> </span>launch<span class="w"> </span>ubuntu:16.04<span class="w"> </span>-p<span class="w"> </span>default<span class="w"> </span>-p<span class="w"> </span>jhartley<span class="w"> </span>demo
Creating<span class="w"> </span>demo
Starting<span class="w"> </span>demo
real<span class="w">    </span>0m9.593s
</pre></div>

<p>Once created, they take about 3 seconds to stop and 0.5 seconds to start.</p>
<p>Those "-p" options cause the container to use two <em>profiles</em>. They are:</p>
<ol>
<li>
<p>The <em>default</em> profile, which I've never touched. It's just doing whatever it
   always does.</p>
</li>
<li>
<p>The <em>jhartley</em> profile, I created in a one-off step by running a Bash script
   derived from instructions one of my colleagues passed around. I'll describe
   it at the end.</p>
</li>
</ol>
<p>Once a new container is up, we can execute commands directly on it:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>lxc<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>demo<span class="w"> </span>hostname
demo
$<span class="w"> </span>lxc<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>demo<span class="w"> </span>whoami
root
</pre></div>

<p>Or SSH to them using their IP address:</p>
<div class="code"><pre class="code literal-block">jhartley@t460<span class="w"> </span>$<span class="w"> </span>lxc<span class="w"> </span>ls<span class="w"> </span>demo
<span class="p">|</span><span class="w"> </span>NAME<span class="w"> </span><span class="p">|</span><span class="w">  </span>STATE<span class="w">  </span><span class="p">|</span><span class="w">        </span>IPV4<span class="w">         </span><span class="p">|</span><span class="w"> </span>IPV6<span class="w"> </span><span class="p">|</span><span class="w">   </span>TYPE<span class="w">    </span><span class="p">|</span><span class="w"> </span>SNAPSHOTS<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>demo<span class="w"> </span><span class="p">|</span><span class="w"> </span>RUNNING<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span>.44.99.162<span class="w"> </span><span class="o">(</span>eth0<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">      </span><span class="p">|</span><span class="w"> </span>CONTAINER<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">         </span><span class="p">|</span>
jhartley@t460<span class="w"> </span>$<span class="w"> </span>ssh<span class="w"> </span><span class="m">10</span>.44.99.162
...
Warning:<span class="w"> </span>Permanently<span class="w"> </span>added<span class="w"> </span><span class="s1">'10.44.99.162'</span><span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span><span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>known<span class="w"> </span>hosts.
Welcome<span class="w"> </span>to<span class="w"> </span>Ubuntu<span class="w"> </span><span class="m">16</span>.04.6<span class="w"> </span>LTS<span class="w"> </span><span class="o">(</span>GNU/Linux<span class="w"> </span><span class="m">5</span>.4.0-25-generic<span class="w"> </span>x86_64<span class="o">)</span>
jhartley@demo<span class="w"> </span>$
</pre></div>

<p>Better than using IP addresses, you can run a DNS server to recognize
<code>{containername}.lxd</code> hostnames. (This part is from
<a href="https://discuss.linuxcontainers.org/t/a-way-to-resolve-container-lxd-from-host-in-all-cases/3698">here</a>.)</p>
<p>Find your lxd bridge IPv4 address</p>
<div class="code"><pre class="code literal-block">lxc<span class="w"> </span>network<span class="w"> </span>show<span class="w"> </span>lxdbr0
</pre></div>

<p>Create file <code>/etc/systemd/network/lxd.network</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">[Match]</span>
<span class="na">Name</span><span class="o">=</span><span class="s">lxdbr0</span>

<span class="k">[Network]</span>
<span class="na">Address</span><span class="o">=</span><span class="s">IPADDR/24</span>
<span class="na">DNS</span><span class="o">=</span><span class="s">IPADDR</span>
<span class="na">Domains</span><span class="o">=</span><span class="s">~lxd</span>
</pre></div>

<p>Where IPADDR is the lxdbr0 IPv4 address.</p>
<div class="code"><pre class="code literal-block">sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>systemd-networkd
sudo<span class="w"> </span>reboot<span class="w"> </span>now
</pre></div>

<p>Then:</p>
<div class="code"><pre class="code literal-block">jhartley@t460<span class="w"> </span>$<span class="w"> </span>ssh<span class="w"> </span>demo.lxd
jhartley@demo<span class="w"> </span>$<span class="w"> </span><span class="c1"># \o/</span>
</pre></div>

<p>One nice thing is that DNS works both from the host and on the containers,
so your services can be configured by default to talk to each other at
SERVICE1.lxd, SERVICE2.lxd. Then running them in containers on your host
they would just find each other. We don't actually do this, but it seems
trivially easy to do. I should ask why we don't.</p>
<p>In practice I wrap up the ssh command with my accumulated foibles:</p>
<div class="code"><pre class="code literal-block">jhartley@demo<span class="w"> </span>$<span class="w"> </span><span class="nb">type</span><span class="w"> </span>-a<span class="w"> </span>lssh
lssh<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span><span class="k">function</span>
lssh<span class="w"> </span><span class="o">()</span>
<span class="o">{</span>
<span class="w">    </span><span class="nv">TERM</span><span class="o">=</span>xterm-color<span class="w"> </span>ssh<span class="w"> </span>-A<span class="w"> </span>-t<span class="w"> </span><span class="s2">"</span><span class="nv">$1</span><span class="s2">.lxd"</span><span class="w"> </span>--<span class="w"> </span><span class="s2">"cd </span><span class="nv">$PWD</span><span class="s2"> &amp;&amp; exec </span><span class="nv">$SHELL</span><span class="s2"> -l"</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>

<p>I forget why -A and -t were required. The rest is mostly just to start the
shell on the container in the same directory as I was in on the host. There
is probably a simpler way.</p>
<hr>
<p>The booooooring bits:</p>
<p>When we started the container, we mentioned
<a href="files/2020/setup-lxd-profile.sh">a one-off setup script</a>.</p>
<p>The script does a few things:</p>
<ol>
<li>Creates a new key pair specifically to SSH to the container.</li>
<li>Creates the custom <em>jhartley</em> profile, which causes all containers started
   with it to:</li>
<li>Create a new user on the container with user and group ID mapped to
      those of my user on the host, presumably so that file permissions work
      for...</li>
<li>Mount my $HOME directory on the container. Might not always be what you
      want, but works for me right now.</li>
<li>Doubtless due to my own misunderstanding somewhere, in order to get working
   IPv4 connections to my containers, I had to disable IPv6 connections to
   them.</li>
</ol>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/dina-as-otf/" class="u-url">Dina font as an OTF.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/dina-as-otf/" rel="bookmark">
            <time class="published dt-published" datetime="2020-02-05T14:51:33-06:00" itemprop="datePublished" title="2020-02-05 14:51">2020-02-05 14:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>The Dina font, converted to an OpenType Font (see screenshots at the bottom of
the page):</p>
<h2><a href="files/2020/Dina-v2.93-otf.tar.gz"><span class="emoji">📦</span> Dina-v2.93-otf.tar.gz</a></h2>
<p><a href="https://gitlab.gnome.org/GNOME/pango/issues/386">Pango dropped support for naive bitmap fonts</a>
in v1.44 -- i.e. from Ubuntu 20.04, <em>Focal</em>, onwards.</p>
<p>So all bitmap fonts need to be converted into a format that will render,
ie. a vector format such as OpenType that allows bitmaps to be embedded.
(Not a conversion of the bitmap into an outline, losing the advantages of
the crisp, tiny bitmaps.)</p>
<p>For most bitmap fonts, this conversion will be done for you, by packagers
or font authors.</p>
<p>But you'll need to do it yourself for any peripheral fonts that you love
more than your distribution does. Here's how I did it for my
<a href="http://www.dcmembers.com/jibsen/download/61/">beloved Dina</a>.</p>
<h3>1. Identify the font file.</h3>
<div class="code"><pre class="code literal-block">fc-list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Dina
</pre></div>

<h3>2. Convert.</h3>
<p>Use either command line tools, or fontforge.</p>
<h4>2.1 Using fontforge</h4>
<p>A GUI tool.</p>
<ol>
<li>
<p>Open up fontforge, paste the font path in.</p>
</li>
<li>
<p>File / generate fonts.</p>
</li>
<li>
<p>Select:</p>
</li>
<li>
<p>Left dropdown: "OpenType (CFF)"</p>
</li>
<li>Right dropdown: "In TTF/OTF"</li>
<li>Generate</li>
</ol>
<p>The results have some problems. I'm using it in gnome-terminal:</p>
<ul>
<li>People converting other fonts report issues with ugly gaps between
  characters. But I don't see that, perhaps because it's a monospace font?</li>
<li>The converted font is invisible in font selection dialogs, making it look
  like the process did not work. But once selected, by clicking around blindly,
  then the font displays fine in applications.</li>
<li>Using a font size which is not defined in the font displays a blank terminal,
  instead of falling back to some other font.</li>
<li>Using ctrl-+/- to select font sizes cycles through three of the four
  defined sizes. I don't know why it skips one. But all four are usable if
  you explicitly select a size.</li>
</ul>
<h3>2.2 Using command-line tools</h3>
<p>The process is described at
https://fedoraproject.org/wiki/BitmapFontConversion.</p>
<p>Ubuntu's released version of fonttosfnt (1.0.4) produces unusable results:
* Only the 1st and 2nd smallest font sizes are preserved.
* In the 2nd smallest size, all variations are too bold, so that 'bold'
  variations look 'double-bold'. (Italics looks really ugly too, this may
  just be a result of the enboldening.)</p>
<p>TODO: Consider trying the latest fonttosfnt (1.1.0)
https://gitlab.freedesktop.org/xorg/app/fonttosfnt
or at least filing an issue there to try and get some help.</p>
<h3>3. Install</h3>
<ul>
<li>Copy to <code>~/.local/share/fonts</code> (or <code>~/.fonts</code>, right?)</li>
<li><code>fc-cache -f</code></li>
</ul>
<h3>The result</h3>
<p>I know, it doesn't look like much.</p>
<p><img alt="" src="files/2020/terminal-dina-small-ll.png"></p>
<p>But compare it with a regular vector font. Here's Ubuntu Mono, the <em>best</em> of
the vector fonts I could find at these sizes. Blurry and inconsistent and hard
to read:</p>
<p><img alt="" src="files/2020/terminal-ubuntumono-small-ll.png"></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/conky/" class="u-url">Conky.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/conky/" rel="bookmark">
            <time class="published dt-published" datetime="2020-01-15T16:09:13-06:00" itemprop="datePublished" title="2020-01-15 16:09">2020-01-15 16:09</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In the typical mad-scientist thrills-per-minute that is the Linux way,
adding a CPU meter to my desktop involved crafting
<a href="https://github.com/tartley/dotfiles/tree/main/.config/conky">my own conky configuration file</a>.</p>
<p>As always, building your own is a chore that crops up when you least expect
it. But on the other hand, the opportunity for functional and aesthetic
work results in something artisnally crafted to exactly meet your own personal
needs. Something you can feel a little pride about. An elegant weapon,
for a more... civilized age.</p>
<p><img alt="An elegant weapon, for a more... civilised age." src="files/2020/conky.jpg"></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/vonnegut-on-software-development-teams/" class="u-url">Vonnegut on software development teams.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/vonnegut-on-software-development-teams/" rel="bookmark">
            <time class="published dt-published" datetime="2019-06-30T21:28:04-05:00" itemprop="datePublished" title="2019-06-30 21:28">2019-06-30 21:28</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>So here's a thing. Spotted this in some of Kurt Vonnegut's personal
correspondence, talking about an instructor of his named Slotkin:</p>
<blockquote>
<p>What Slotkin said was this: no man who achieved greatness in the arts operated
by himself; he was top man in a group of like-minded individuals. This works
out fine for the cubists, and Slotkin had plenty of good evidence for its
applying to Goethe, Thoreau, Hemingway, and just about anybody you care to
name.</p>
<p>If this isn't 100% true, it's true enough to be interesting—and maybe helpful.</p>
<p>The school gives a man, Slotkin said, the fantastic amount of guts it takes to
add to culture. It gives him morale, esprit de corps, the resources of many
brains, and—maybe most important—one-sidedness with assurance.</p>
</blockquote>
<p>Reminds me powerfully of my growing impressions of the environment a person
needs to be in in order to do great things in software. There is no doubt some
effectiveness in assembling great individuals to create a great team.</p>
<p>But in my personal experience, there is a whole lot <em>more</em> value in creating a
great team by instilling the right values, and then watching the members
visibly level each other up, producing a succession of great individuals,
and only subsequently attracting more of the same.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/swamp-thing/" class="u-url">Swamp Thing, Vol 1: Saga of the Swamp Thing</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/swamp-thing/" rel="bookmark">
            <time class="published dt-published" datetime="2019-06-23T21:50:43-05:00" itemprop="datePublished" title="2019-06-23 21:50">2019-06-23 21:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><span style="float: left">
<img alt="Swamp Thing cover" src="files/2019/06/swamp-thing-vol-1.jpg"></span></p>
<p><em>by Alan Moore, Jogn Totleben, &amp; Steve Bissette</em> <img alt="spoilers" src="files/spoilers.svg"></p>
<p>Moore's deconstruction of existing characters continues. Originally Swamp Thing
was Alec Holland, miraculously transformed by an infusion of artificially
stimulated plant matter. When Alan Moore takes over the writing, Swamp Thing's
ostracization and existential dread is compounded by the discovery that this
origins story has been a delusion all along. Alec Holland was killed outright
in the accident, and an accumulation of plant matter grew around his decaying
form, integrating the physical remains of his memories into a creature that
yearned to recapture its human form, but was never human in the first place.</p>
<p><br style="clear: both"></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/miracleman/" class="u-url">Miracleman, books 1, 2 &amp; 3</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Jonathan Hartley
            </span></p>
            <p class="dateline">
            <a href="posts/miracleman/" rel="bookmark">
            <time class="published dt-published" datetime="2019-06-20T10:17:46-05:00" itemprop="datePublished" title="2019-06-20 10:17">2019-06-20 10:17</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><span style="float: left">
<img alt="Miracleman cover" src="files/2019/06/miracleman.jpg"></span></p>
<p><em>by Alan Moore, Alan Davies, &amp; John Totleben.</em>  <img alt="spoilers" src="files/spoilers.svg"></p>
<p>I spent a little time digging out earlier works of Alan Moore. These
inter-library loans didn't disappoint.</p>
<p>Originally published as <em>Marvelman</em> by Mick Anglo, from
1954-59. Legal battles rebranded the character as <em>Miracleman</em> in 1985.</p>
<p>The opening pages reprint one of those campy early stories, involving
primary-colored moralizing while flying around to punch time-travelling Nazi
super-scientists.</p>
<p>They then continue with Alan Moore's postmodern 1980s reboot. This recasts the
simplistic tales of the original period as a placating dream, fed to a captured
Miracleman by his nemesis. His hokey origins story is similarly re-ploughed. The
ensuing tales are dark and introspective.</p>
<p>One thread follows the emotional stresses placed on Miracleman when incarnated
as his human alter-ego, the frail and fallible half of a godlike being. He's
unable to conceive a child with his wife, although <em>Miracleman</em> can, and
succumbs to self-loathing and jealousy, culminating in a touching scene in
which he climbs a mountain, leaves a forlorn monument, and changes into
Miracleman one last time, never to change back.</p>
<p>Yes, this is more uneven than Moore's later works. Yes, it's unashamedly an
underwear-on-the-outside superhero story. But nonetheless I loved it, and
scenes like the above stayed with me for months.</p>
<p>Also this month:</p>
<p><strong>The Atrocity Archive</strong> by Charles Stross. The conceit of Lovecraftian horror
rationalized to a mathematical or computable topic is appealing to me, and
kept the pages turning, but I didn't ultimately find it life-changing.</p>
<p><strong>Nightwings</strong> by Robert Silverberg. A fantastical far-future tale of humanity
split into occupational castes, guarding the world against prophesied
invasion. Not my thing.</p>
<p><br style="clear: both"></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-24.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-22.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer"></footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
