---
layout: post
status: publish
published: true
title: Making a wix installer run a program by default
author:
  display_name: tartley
  login: tartley
  email: tartley@tartley.com
  url: http://tartley.com
author_login: tartley
author_email: tartley@tartley.com
author_url: http://tartley.com
wordpress_id: 847
wordpress_url: http://www.tartley.com/?p=847
date: '2009-10-01 18:27:29 -0500'
date_gmt: '2009-10-01 17:27:29 -0500'
categories:
- Software
tags: []
comments:
- id: 23657
  author: tartley
  author_email: tartley@tartley.com
  author_url: http://tartley.com
  date: '2009-10-01 18:28:44 -0500'
  date_gmt: '2009-10-01 17:28:44 -0500'
  content: Thanks Tom! We figured publishing this was helpful to some poor souls out
    there because we could not successfully find any information on how to get said
    checkbox checked by default, but a bit of guesswork led to the answer above.
- id: 23668
  author: xtian
  author_email: xtian@babbageclunk.com
  author_url: ''
  date: '2009-10-02 07:35:12 -0500'
  date_gmt: '2009-10-02 06:35:12 -0500'
  content: Only least favourite since I left!
- id: 23711
  author: David Jones
  author_email: drj@pobox.com
  author_url: http://drj11.wordpress.com/
  date: '2009-10-05 15:04:21 -0500'
  date_gmt: '2009-10-05 14:04:21 -0500'
  content: ah, you mean Tom really exists?  I thought for a moment that "Tom" might
    be you, tartley, when you were made to write windows installers.
- id: 23720
  author: tartley
  author_email: tartley@tartley.com
  author_url: http://tartley.com
  date: '2009-10-06 13:29:59 -0500'
  date_gmt: '2009-10-06 12:29:59 -0500'
  content: Tom is one of my many superlative workmates. He purportedly finds existence
    to be an over-rated quality, but nevertheless it is one which he indubitably possesses.
    Tom and I were pair-programming on the day in question.
---
<p><em><strong>Guest post by my least favourite colleague, Tom.</strong></em></p>
<p>Normally - but not always - people want to run a program just after the install it - you can help then to do this by using an opt-out system with a checkbox checked by default</p>
<p>To create the checkbox and control whether it is set you must use the following properties in your <strong>Product</strong> section:</p>
<p>[xml]</p>
<p><Property<br />
 Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT"<br />
 Value="Launch the cool program" /><br />
<Property<br />
 Id="WIXUI_EXITDIALOGOPTIONALCHECKBOX"<br />
 Value="1" /></p>
<p>[/xml]</p>
<p>The value of <strong>WIXUI_EXITDIALOGOPTIONALCHECKBOX</strong> controls the checkboxes checkedness.</p>
<p>You then need a custom action to do some launching:</p>
<p>[xml]</p>
<p><Property Id="WixShellExecTarget" Value="[#ID-of-the-thing-that-you-want-to-run]" /><br />
 <CustomAction<br />
 Id="LaunchApplication"<br />
 BinaryKey="WixCA"<br />
 DllEntry="WixShellExec"<br />
 Impersonate="yes" /></p>
<p>[/xml]</p>
<p>and some UI wiring in the <strong>UI</strong> element under the <strong>Product</strong> element to get you custom action called.</p>
<p>[xml]</p>
<p><Publish Dialog="ExitDialog"<br />
 Control="Finish"<br />
 Event="DoAction"<br />
 Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish></p>
<p>[/xml]</p>
<p>Huzzah - you now may have a working installer.</p>
